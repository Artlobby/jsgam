{"version":3,"file":"jsgam.js","sources":["../src/loader.js","../src/storage.js","../src/soundmanager.js","../src/class/scene.js","../src/class/text.js","../src/class/menu.js","../src/class/mainmenu.js","../src/class/options.js","../src/class/help.js","../src/class/credits.js","../src/class/confirmation.js","../src/class/title.js","../src/class/gamescene.js","../src/class/cutscene.js","../src/collisions.js","../src/class/gameobject.js","../src/class/inventory.js","../src/class/puzzle.js","../src/class/character.js","../src/class/player.js","../src/class/npc.js","../src/class/dialogue.js","../src/class/logo.js","../src/game.js","../src/index.js"],"sourcesContent":["import {Howl, Howler} from 'howler';\r\n\r\nclass Loader extends PIXI.loaders.Loader{\r\n  constructor(){\r\n    super();\r\n    this.game=null;\r\n    this.onLoad.add(this.update.bind(this));\r\n    this.onError.add(this.error.bind(this));\r\n    this.use(this.howlerMiddleware.bind(this));\r\n  }\r\n\r\n  howlerMiddleware(resource,next){\r\n    if (resource && [\"wav\", \"ogg\", \"mp3\"].includes(resource.extension)) {\r\n      const options = JSON.parse(JSON.stringify(resource.metadata));\r\n      options.src = [resource.url];\r\n      resource.sound = new Howl(options);\r\n      next();\r\n    }else next();\r\n  }\r\n\r\n  //Add config files to loader\r\n  addJSON(files){\r\n    let i;\r\n    let arrayLength=files.length;\r\n\r\n    for(i=0;i<arrayLength;i++){\r\n      let name=files[i].slice(files[i].lastIndexOf(\"/\")+1,files[i].lastIndexOf(\".\"));\r\n      this.add(name,files[i]);\r\n    }\r\n  }\r\n\r\n  //Add resource files to loader and settings to game\r\n  addFiles(files){\r\n    let i;\r\n    let length=files.length\r\n    for(i=0;i<length;i++){\r\n      //Add config files to setup the game\r\n      if(files[i].data.Settings) this.game.settings=files[i].data.Settings;\r\n      if(files[i].data.Scenes) this.game.data.scenes=this.game.data.scenes.concat(files[i].data.Scenes);\r\n      if(files[i].data.Cutscenes) this.game.data.cutscenes=this.game.data.cutscenes.concat(files[i].data.Cutscenes);\r\n      if(files[i].data.Objects) this.game.data.objects=this.game.data.objects.concat(files[i].data.Objects);\r\n      if(files[i].data.Dialogues) this.game.data.dialogues=this.game.data.dialogues.concat(files[i].data.Dialogues);\r\n      if(files[i].data.Puzzles) this.game.data.puzzles=this.game.data.puzzles.concat(files[i].data.Puzzles);\r\n      if(files[i].data.Credits) this.game.data.credits=files[i].data.Credits;\r\n      if(files[i].data.Texts) this.game.data.texts=files[i].data.Texts;\r\n      //Look for sound files\r\n      if(files[i].data.Sounds){\r\n        let soundSrc=files[i].data.Sounds;\r\n        for(let j=0;j<soundSrc.length;j++){\r\n           let tmpSound=soundSrc[j].Src;\r\n           if(tmpSound!==null) this.add(soundSrc[j].Name,tmpSound);\r\n        }\r\n       }\r\n\r\n       //Look for video files\r\n       if(files[i].data.Vids)\r\n       {\r\n         let vidSrc=files[i].data.Vids;\r\n         for(let i=0;i<vidSrc.length;i++){\r\n           let tmpVid=vidSrc[i].Src;\r\n           if(tmpVid!==null) this.add(vidSrc[i].Name,tmpVid);\r\n         }\r\n       }\r\n\r\n       //Load Animations\r\n       if(files[i].data.Animations)\r\n       {\r\n         let animSrc=files[i].data.Animations;\r\n         for(let i=0;i<animSrc.length;i++){\r\n           let tmpAnim=animSrc[i].Src;\r\n           if(tmpAnim!==null) this.add(animSrc[i].Name,tmpAnim);\r\n         }\r\n       }\r\n\r\n       //Load Backgrounds if don't use texture atlas for backgrounds\r\n       if(files[i].data.Backgrounds){\r\n         let bgSrc=files[i].data.Animations;\r\n         for(let i=0;i<bgSrc.length;i++){\r\n           let tmpBg=bgSrc[i].Src;\r\n           if(tmpBg!==null) this.add(bgSrc[i].Name,tmpBg);\r\n         }\r\n       }\r\n\r\n       //Look for player files\r\n       if(files[i].data.Player){\r\n         this.add('playerTex', files[i].data.Player.Texture)\r\n             .add('playerJson', files[i].data.Player.Json)\r\n             .add('playerSkeleton', files[i].data.Player.Skeleton);\r\n         this.game.data.player=files[i].data.Player;\r\n       }\r\n\r\n       //Look for NPC files\r\n       if(files[i].data.Characters){\r\n         let npcSrc=files[i].data.Characters;\r\n         for(let i=0;i<npcSrc.length;i++){\r\n            this.add(npcSrc[i].Name+\"Tex\", npcSrc[i].Texture)\r\n            .add(npcSrc[i].Name+'Json', npcSrc[i].Json)\r\n            .add(npcSrc[i].Name+'Skeleton', npcSrc[i].Skeleton);\r\n          }\r\n          this.game.data.npc=files[i].data.Characters;\r\n        }\r\n    }\r\n  }\r\n\r\n  //Loading progress\r\n  update(){\r\n    let percent=Math.floor(this.progress);\r\n    this.game.progressBar.width=(this.game.width/100)*percent;\r\n    //this.game.loadingTxt.text=\"Loading... \"+ percent+\"%\";\r\n  }\r\n\r\n  //File failed to load\r\n  error(resource){\r\n    console.log(resource);\r\n  }\r\n\r\n}\r\n\r\nexport default Loader;\r\n","import localForage from 'localforage';\r\n\r\nexport default class Storage{\r\n  constructor(game){\r\n    this.game=game;\r\n  }\r\n\r\n  //Save adventure progress\r\n  save(){\r\n    //Get solved puzzles\r\n    let puzzlesSolved=[];\r\n    let puzzleArray=Object.values(this.game.puzzles)\r\n\r\n    puzzleArray.forEach(function(puzzle){\r\n      if(puzzle.solved && !puzzlesSolved.includes(puzzle.config.Name))\r\n        puzzlesSolved.push(puzzle.config.Name)\r\n    });\r\n\r\n    //Get dialogues\r\n    let dialoguesDisabled=[];\r\n    let dialogueArray=Object.values(this.game.dialogues);\r\n\r\n\r\n    dialogueArray.forEach(function(dialogue){\r\n      let branches=Object.values(dialogue.branches);\r\n\r\n      branches.forEach(function(branch){\r\n\r\n        branch.Choices.forEach(function(choice,index){\r\n          if(choice.disabled){\r\n            let disabledOption={\r\n              Dialogue:dialogue.config.Name,\r\n              Branch:branch.Name,\r\n              Index:index\r\n            }\r\n            dialoguesDisabled.push(disabledOption);\r\n          }\r\n        });\r\n      });\r\n\r\n    });\r\n\r\n    //Get player cutscenes\r\n    let cutscenesPlayed=[];\r\n    let cutscenesArray=Object.values(this.game.cutscenes);\r\n    cutscenesArray.forEach(function(cutscene){\r\n      if(cutscene.played) cutscenesPlayed.push(cutscene.config.Name);\r\n    });\r\n\r\n    //Store the progress\r\n    this.progress={\r\n      language:this.game.activeLanguage,\r\n      latestScene:this.game.activeScene.config.Name,\r\n      playerPos:[this.game.player.sprite.x,this.game.player.sprite.y],\r\n      inventory:this.game.inventory.objects,\r\n      puzzles:puzzlesSolved,\r\n      dialogues:dialoguesDisabled,\r\n      cutscenes:cutscenesPlayed\r\n    }\r\n\r\n    //Save object to local storage\r\n    localForage.setItem('JSGAM_Storage', this.progress);\r\n  }\r\n\r\n  //Load adventure progress\r\n  load(){\r\n    let game=this.game;\r\n\r\n    //Disable dialogues finished\r\n    this.progress.dialogues.forEach(function(disable){\r\n      game.dialogues[disable.Dialogue].branches[disable.Branch].Choices[disable.Index].disabled=true;\r\n    });\r\n\r\n    //Disable cutscenes played\r\n    this.progress.cutscenes.forEach(function(name){\r\n      game.cutscenes[name].played=true;\r\n    });\r\n\r\n    this.game.silentMode=true;\r\n    //Resolve puzzles already done\r\n    this.progress.puzzles.forEach(function(name){\r\n      game.puzzles[name].resolve();\r\n    });\r\n    \r\n    //Load objects in inventory\r\n    this.progress.inventory.forEach(function(item){\r\n\r\n      //Add object to inventory\r\n      game.inventory.add(item);\r\n\r\n      //Remove objects from scenes configurations\r\n      let thisItem=item;\r\n      let sceneArray=Object.values(game.scenes);\r\n      sceneArray.forEach(function(scene){\r\n        if(scene.config.Objects!==undefined && scene.config.Objects.includes(thisItem)){\r\n          let tmpIndex=scene.config.Objects.indexOf(thisItem);\r\n          scene.config.Objects.splice(tmpIndex,1);\r\n        }\r\n      })\r\n\r\n    });\r\n    this.game.silentMode=false\r\n\r\n    //Add player to latest Position\r\n    this.game.player.sprite.x=this.progress.playerPos[0];\r\n    this.game.player.sprite.y=this.progress.playerPos[1];\r\n\r\n  }\r\n\r\n  //Clear local storage\r\n  delete(){\r\n    localForage.clear();\r\n  }\r\n\r\n  check(){\r\n    let storage=this;\r\n\r\n    localForage.getItem('JSGAM_Storage').then(function(value) {\r\n      // This code runs once the value has been loaded\r\n      // from the offline store.\r\n      if(value!==null){\r\n        storage.progress=value;\r\n        storage.game.activeLanguage=value.language;\r\n        storage.game.scenes[\"Title\"].changeLanguage();\r\n        storage.game.scenes[\"Title\"].states[\"MainMenu\"].enable(\"Continue\");\r\n      }\r\n    }).catch(function(err) {\r\n        // This code runs if there were any errors\r\n        console.log(err);\r\n    });\r\n  }\r\n}\r\n","export default class SoundManager{\r\n  constructor(game){\r\n    this.game=game;\r\n  }\r\n\r\n  play(source){\r\n    let sound=this.game.files.resources[source].sound;\r\n    sound.loop(true);\r\n    sound.play();\r\n  }\r\n\r\n  stop(source){\r\n    let sound=this.game.files.resources[source].sound;\r\n    sound.on('fade', this.onFade.bind(sound));\r\n    sound.fade(1,0,1000);\r\n  }\r\n\r\n  onFade(){\r\n    this.stop();\r\n    this.volume(1);\r\n  }\r\n\r\n}\r\n","class Scene{\r\n  constructor(){\r\n    this.container = new PIXI.Container();\r\n    this.game=null;\r\n  }\r\n\r\n  setup(config){\r\n    this.background=new PIXI.Sprite(PIXI.Texture.from(config.Background));\r\n    this.background.anchor.set(0);\r\n    this.container.addChild(this.background);\r\n    if(config.Foreground!==undefined)\r\n    {\r\n      this.foreground=new PIXI.Sprite(PIXI.Texture.from(config.Foreground));\r\n      this.foreground.anchor.set(0);\r\n      this.container.addChild(this.foreground);\r\n    }\r\n    this.music=config.Music;\r\n    this.config=config;\r\n  }\r\n\r\n  update(dt) {\r\n\r\n  }\r\n  hide(){\r\n    this.container.visible=false;\r\n  }\r\n\r\n  show(){\r\n    this.container.visible=true;\r\n  }\r\n}\r\n\r\nexport default Scene;\r\n","class Button extends PIXI.extras.BitmapText{\r\n    constructor(text,style){\r\n      super(text,style);\r\n      this.interactive=true;\r\n      this.buttonMode=true;\r\n    }\r\n}\r\n\r\nclass Infotxt extends PIXI.extras.BitmapText{\r\n    constructor(text,style){\r\n      super(text,style);\r\n    }\r\n}\r\n\r\n\r\nclass Phrases{\r\n  constructor(config){\r\n    this.container=new PIXI.Container();\r\n    this.hide();\r\n    this.game=config;\r\n    this.option=[];\r\n\r\n    for(let i=0;i<this.game.dialogueChoices;i++){\r\n      this.option[i]=new Button(\"Option\",this.game.settings.Text.ButtonStyle);\r\n      this.option[i].game=this.game;\r\n      this.option[i].anchor.set(0.5,0);\r\n      this.option[i].on('pointertap', this.onTap.bind(this.option[i]));\r\n      this.option[i].index=i;\r\n      this.container.addChild(this.option[i]);\r\n      this.option[i].x=this.container.width/2;\r\n      if(i>0)this.option[i].y=this.option[i-1].y+this.option[i-1].height;\r\n    }\r\n  }\r\n\r\n  show(){\r\n    this.container.visible=true;\r\n  }\r\n\r\n  hide(){\r\n    this.container.visible=false;\r\n  }\r\n\r\n  onTap(){\r\n    let activeChoice=this.game.activeDialogue.currentBranch.Choices;\r\n\r\n    if(this.alpha==1){\r\n      this.game.activeDialogue.choice=this.index;\r\n      if(activeChoice[this.index].Repeat==false) activeChoice[this.index].disabled=true;\r\n      this.game.activeDialogue.next();\r\n    }\r\n  }\r\n\r\n  get(){\r\n    this.clear();\r\n    let options=this.game.activeDialogue.currentBranch.Choices;\r\n    for(let i=0;i<options.length;i++){\r\n      if(options[i].disabled){\r\n        this.option[i].alpha=0.5;\r\n      }else this.option[i].alpha=1;\r\n      this.option[i].visible=true;\r\n      this.option[i].text=options[i].Text[this.game.activeLanguage];\r\n    }\r\n    this.sort();\r\n    this.show();\r\n  }\r\n\r\n  clear(){\r\n    for(let i=0;i<this.option.length;i++){\r\n      this.option[i].visible=false;\r\n    }\r\n  }\r\n\r\n  sort(){\r\n    for(let i=0;i<this.option.length;i++){\r\n      this.option[i].x=this.container.width/2;\r\n    }\r\n    if(this.container.width>this.container.parent.width || this.container.height>this.container.parent.height){\r\n      this.scale();\r\n    }\r\n    this.center();\r\n  }\r\n\r\n  scale(){\r\n    let ratio = Math.min( this.game.width/this.container.width,  this.container.parent.height/this.container.height);\r\n    this.container.scale.set(ratio*0.95)\r\n  }\r\n\r\n  center(){\r\n    this.container.x = this.game.width / 2;\r\n  //  this.container.y = this.game.height / 2;\r\n    this.container.pivot.x = this.container.width / 2;\r\n  //  this.container.pivot.y = this.container.height / 2;\r\n  }\r\n}\r\n\r\nclass TextField{\r\n  constructor(){\r\n    this.container=new PIXI.Container();\r\n    this.Avatar=null;\r\n    this.Background=null;\r\n    this.Text=null;\r\n    this.container.visible=false;\r\n  }\r\n\r\n  build(){\r\n    this.container.parentLayer = this.game.layerUI;\r\n    this.Background=new PIXI.Sprite(PIXI.Texture.WHITE);\r\n\r\n    let size=4;\r\n    if(this.game.settings.Text.Size!==undefined){\r\n      if(this.game.settings.Text.Size===\"fourth\") size=4;\r\n      else if(this.game.settings.Text.Size===\"half\") size=2;\r\n    }\r\n    this.Background.width=this.game.width;\r\n    this.Background.height=this.game.height/size;\r\n\r\n    this.Background.tint='black';\r\n    this.Background.alpha=0.5;\r\n\r\n    this.Avatar=new PIXI.Sprite(PIXI.Texture.from(this.game.data.player.Avatar));\r\n    let ratio=this.Avatar.width / this.Avatar.height;\r\n    this.Avatar.height=this.Background.height;\r\n    this.Avatar.width=this.Avatar.height*ratio*0.95;\r\n\r\n    this.Text=new Button(\"\", this.game.settings.Text.Style);\r\n    this.Text.x=this.Avatar.width*1.05;\r\n  //  this.Text.anchor.set(0.5,0);\r\n    this.Text.maxWidth=this.game.width-this.Avatar.width;\r\n\r\n    this.Text.y=0;\r\n    this.Text.on('pointertap',this.skip.bind(this));\r\n\r\n    this.Choices=new Phrases(this.game);\r\n\r\n    this.container.addChild(this.Background);\r\n    this.container.addChild(this.Avatar);\r\n    this.container.addChild(this.Text);\r\n    this.container.addChild(this.Choices.container);\r\n\r\n    //this.Text.x=this.container.width/2;\r\n    this.Choices.sort();\r\n    if(this.game.settings.Text.Position!==undefined) this.setPosition(this.game.settings.Text.Position);\r\n  }\r\n\r\n  show(){\r\n    this.Text.visible=true;\r\n    this.container.visible=true;\r\n  }\r\n\r\n  hide(){\r\n    this.container.visible=false;\r\n  }\r\n\r\n  end(){\r\n    if(this.game.activeDialogue!==null){\r\n      this.talker.shutup();\r\n      if(this.game.activeDialogue.choice!==null) this.game.activeDialogue.answer();\r\n      else{\r\n        this.Text.visible=false;\r\n        this.Avatar.visible=false;\r\n        this.Choices.get();\r\n      }\r\n\r\n    }else{\r\n      this.setText(\"\");\r\n      this.hide();\r\n      this.talker.shutup();\r\n      this.game.player.stop();\r\n      if(this.game.activeObject!==null) this.game.activeObject.cancel();\r\n    }\r\n  }\r\n\r\n  skip(){\r\n    this.end();\r\n    if(this.talker) clearTimeout(this.talker.timeoutID);\r\n  }\r\n\r\n  setPosition(position){\r\n    if(position===\"top\"){\r\n      this.container.x=0;\r\n      this.container.y=0;\r\n    }else if(position===\"bottom\"){\r\n      this.container.x=0;\r\n      this.container.y=this.game.height-this.container.height;\r\n    }\r\n  }\r\n\r\n  setText(newText){\r\n    this.Text.text=newText;\r\n    if(this.Text.width>this.container.width || this.Text.height>this.container.height){\r\n      this.adjustText();\r\n    }\r\n  }\r\n\r\n  adjustText(){\r\n    let ratio = Math.min( this.container.width/this.Text.width,  this.container.height/this.Text.height);\r\n    this.container.scale.set(ratio*0.95);\r\n  }\r\n\r\n  //Get words number of the text\r\n  countWords(str) {\r\n   return str.split(\" \").length;\r\n  }\r\n\r\n  //Calculate how many seconds we show the text\r\n  timeOut(){\r\n    let time;\r\n    if(this.game.settings.Text.Speed!==undefined) time=this.game.settings.Text.Speed;\r\n    else time=this.countWords(this.Text.text)/3;\r\n\r\n    //Time must be at least 1 second\r\n    if(time<1) time=1;\r\n\r\n    return time*1000;\r\n  }\r\n\r\n  setColor(colour){\r\n    this.Text.tint=colour;\r\n  }\r\n\r\n  setFont(newFont){\r\n    this.Text.font=newFont;\r\n  }\r\n\r\n  setAvatar(newAvi){\r\n    this.Avatar.visible=true;\r\n    this.Avatar.texture=(PIXI.Texture.from(newAvi));\r\n  }\r\n\r\n  hideAvatar(){\r\n    this.Avatar.visible=false;\r\n  }\r\n\r\n}\r\n\r\nexport {Button,TextField,Infotxt};\r\n","import {Button} from './text.js'\r\n\r\nclass Menu{\r\n  constructor(){\r\n    this.container=new PIXI.Container();\r\n    this.game=null;\r\n    this.buttons={};\r\n    }\r\n\r\n  addButton(name,text){\r\n    this.buttons[name]=new Button(text[this.game.activeLanguage],this.game.settings.Text.ButtonStyle);\r\n    this.container.addChild(this.buttons[name]);\r\n  }\r\n\r\n  modify(name,text){\r\n    this.buttons[name].text=text[this.game.activeLanguage];\r\n  }\r\n\r\n  disable(name){\r\n    this.buttons[name].alpha=0.5;\r\n    this.buttons[name].interactive=false;\r\n  }\r\n\r\n  enable(name){\r\n    this.buttons[name].alpha=1.0;\r\n    this.buttons[name].interactive=true;\r\n  }\r\n\r\n  sort(){\r\n    let i;\r\n    let arrayButtons=Object.values(this.buttons);\r\n    let length=arrayButtons.length;\r\n    arrayButtons[0].y=0;\r\n    for(i=1;i<length;i++)\r\n    {\r\n      arrayButtons[i].y=arrayButtons[i-1].y+arrayButtons[i-1].height*1.5;\r\n      arrayButtons[i].x=this.container.width/2-arrayButtons[i].width/2;\r\n    }\r\n\r\n    this.center();\r\n  //  this.resize();\r\n  }\r\n\r\n  resize(){\r\n    let ratio = Math.min( this.game.width/this.container.width,  this.game.height/this.container.height);\r\n    //console.log(ratio)\r\n    this.container.scale.set(ratio*0.95);\r\n  }\r\n\r\n  hide(){\r\n    this.container.visible=false;\r\n  }\r\n\r\n  show(){\r\n    this.container.visible=true;\r\n  }\r\n\r\n  center(){\r\n    this.container.x = this.game.width / 2;\r\n    this.container.y = this.game.height / 2;\r\n    this.container.pivot.x = this.container.width / 2;\r\n    this.container.pivot.y = this.container.height / 2;\r\n  }\r\n\r\n}\r\nexport default Menu;\r\n","import Menu from './menu.js';\r\n\r\nclass MainMenu extends Menu{\r\n  create(){\r\n      let gameTexts=this.game.data.texts;\r\n      this.addButton(\"New\",gameTexts.NewGame);\r\n      this.addButton(\"Continue\",gameTexts.Continue);\r\n      this.addButton(\"Options\",gameTexts.Options);\r\n      this.addButton(\"Help\",gameTexts.Help);\r\n      this.addButton(\"Credits\",gameTexts.Credits);\r\n\r\n      this.disable(\"Continue\");\r\n\r\n      this.sort();\r\n    }\r\n\r\n  changeLanguage(){\r\n    this.modify(\"New\",this.game.data.texts.NewGame);\r\n    this.modify(\"Continue\",this.game.data.texts.Continue);\r\n    this.modify(\"Options\",this.game.data.texts.Options);\r\n    this.modify(\"Help\",this.game.data.texts.Help);\r\n    this.modify(\"Credits\",this.game.data.texts.Credits);\r\n\r\n    this.sort();\r\n  }\r\n\r\n}\r\nexport default MainMenu;\r\n","import Menu from './menu.js';\r\nimport {Button} from './text.js';\r\n\r\nclass Options extends Menu{\r\n  create(){\r\n    this.container.visible=false;\r\n    let languages=this.game.settings.Languages\r\n    for(let i=0;i<languages.length;i++){\r\n      this.addLanguage(languages[i],);\r\n      this.buttons[languages[i]].on('pointerup', this.setLanguage);\r\n    }\r\n\r\n    let langArray=Object.values(this.buttons);\r\n    langArray[this.game.activeLanguage].tint=0xFF0000;\r\n\r\n    this.addButton(\"Back\",this.game.data.texts.Back);\r\n    this.sort();\r\n  }\r\n\r\n  addLanguage(name){\r\n    this.buttons[name]=new Button(name,this.game.settings.Text.ButtonStyle);\r\n    this.buttons[name].father=this;\r\n    this.container.addChild(this.buttons[name]);\r\n  }\r\n\r\n  setLanguage(){\r\n    this.father.change(this.text);\r\n  }\r\n\r\n  change(text){\r\n    let languages=this.game.settings.Languages\r\n    this.buttons[languages[this.game.activeLanguage]].tint=0xFFFFFF;\r\n    this.game.activeLanguage=this.game.settings.Languages.indexOf(text);\r\n    this.buttons[languages[this.game.activeLanguage]].tint=0xFF0000;\r\n    this.modify(\"Back\",this.game.data.texts.Back);\r\n    this.sort();\r\n  }\r\n\r\n}\r\nexport default Options;\r\n","class Help{\r\n  constructor(){\r\n    this.container=new PIXI.Container();\r\n    this.container.visible=false;\r\n    this.container.interactive=true;\r\n    this.container.buttonMode=true;\r\n    }\r\n\r\n  create(){\r\n    let config=this.game.settings;\r\n\r\n    this.background=new PIXI.Sprite(PIXI.Texture.from(config.Help[this.game.activeLanguage]));\r\n    this.container.addChild(this.background);\r\n    this.center();\r\n    this.container.on('pointerup', this.mainMenu.bind(this));\r\n  }\r\n\r\n  show(){\r\n    this.container.visible=true;\r\n  }\r\n\r\n  hide(){\r\n    this.container.visible=false;\r\n  }\r\n\r\n  changeLanguage(){\r\n    this.background.texture=PIXI.Texture.from(this.game.settings.Help[this.game.activeLanguage]);\r\n    this.center();\r\n  }\r\n\r\n  center(){\r\n    this.container.x = this.game.width / 2;\r\n    this.container.y = this.game.height / 2;\r\n    this.container.pivot.x = this.container.width / 2;\r\n    this.container.pivot.y = this.container.height / 2;\r\n  }\r\n  mainMenu(){\r\n    this.game.scenes[\"Title\"].mainMenu();\r\n  }\r\n}\r\n\r\nexport default Help;\r\n","import { TweenMax } from \"gsap\";\r\nimport PixiPlugin from \"gsap/PixiPlugin\";\r\n\r\nclass Credits{\r\n  constructor(){\r\n    this.container=new PIXI.Container();\r\n    this.container.visible=false;\r\n    this.container.interactive=true;\r\n    this.container.buttonMode=true;\r\n    }\r\n\r\n  create(){\r\n    let config=this.game.data.credits;\r\n\r\n    if(config.Background!==undefined){\r\n      this.background=new PIXI.Sprite(PIXI.Texture.from(config.Background));\r\n      this.container.addChild(this.background);\r\n    }\r\n\r\n    this.buildText();\r\n    this.speed=null;\r\n\r\n    if(this.game.data.credits.Time!==undefined){\r\n      this.speed=this.game.data.credits.Time;\r\n    }else{\r\n      this.speed=20;\r\n    }\r\n\r\n    this.structuredText = new PIXI.extras.BitmapText(this.text,config.Style);\r\n    this.tween=null;\r\n    this.container.addChild(this.structuredText);\r\n\r\n    this.container.x = this.game.width / 2;\r\n    this.container.pivot.x = this.container.width / 2;\r\n    this.container.y=this.game.height;\r\n    this.container.on('pointerup', this.mainMenu.bind(this));\r\n  }\r\n\r\n  show(){\r\n    this.container.visible=true;\r\n    this.animate();\r\n  }\r\n\r\n  animate(){\r\n    TweenMax.set(this.container,{y: this.game.height});\r\n    this.tween=TweenMax.to(this.container, 20, {y: 0 - this.container.height,onComplete:this.mainMenu.bind(this)});\r\n  }\r\n\r\n  hide(){\r\n    this.container.visible=false;\r\n  }\r\n\r\n\r\n  buildText(){\r\n    let credits=this.game.data.credits;\r\n\r\n    this.text=\"\";\r\n    let i;\r\n    for (i=0; i < credits.Lines.length; i++) {\r\n    this.text += credits.Lines[i].Title[this.game.activeLanguage];\r\n    this.text += \"\\n\";\r\n    let j;\r\n\r\n    for (j = 0; j < credits.Lines[i].Text.length; j++) {\r\n      this.text += credits.Lines[i].Text[j];\r\n      this.text += \"\\n\";\r\n    }\r\n    this.text += \"\\n\";\r\n    }\r\n  }\r\n\r\n  update(){\r\n    //PIXI.tweenManager.update();\r\n  }\r\n\r\n  changeLanguage(){\r\n    this.buildText();\r\n    this.structuredText.text=this.text;\r\n  }\r\n\r\n  mainMenu(){\r\n    this.tween.kill();\r\n    this.game.scenes[\"Title\"].mainMenu();\r\n  }\r\n}\r\n\r\nexport default Credits;\r\n","import Menu from './menu.js';\r\nimport {Infotxt} from './text.js'\r\n\r\nclass Confirmation extends Menu{\r\n  create(){\r\n    this.hide();\r\n    let gameTexts=this.game.data.texts;\r\n    this.addText(\"Warning\",gameTexts.Warning);\r\n    this.addButton(\"Yes\",gameTexts.Yes);\r\n    this.addButton(\"No\",gameTexts.No);\r\n    this.sort();\r\n  }\r\n\r\n  changeLanguage(){\r\n    //this.modify(\"Warning\",this.game.data.texts.Warning);\r\n    this.text.text=this.game.data.texts.Warning[this.game.activeLanguage];\r\n    this.modify(\"Yes\",this.game.data.texts.Yes);\r\n    this.modify(\"No\",this.game.data.texts.No);\r\n    this.sort();\r\n  }\r\n\r\n  sort(){\r\n    this.text.y=0\r\n    this.text.x=this.game.width/2-this.text.width/2;\r\n    this.buttons[\"Yes\"].y=this.text.height*1.5;\r\n    this.buttons[\"Yes\"].x=this.buttons[\"Yes\"].width;\r\n    this.buttons[\"No\"].y=this.text.height*1.5;\r\n    this.buttons[\"No\"].x=this.game.width-this.buttons[\"No\"].width*2;\r\n    this.container.y=this.game.height/2-this.container.height/2;\r\n  }\r\n\r\n  mainMenu(){\r\n    this.game.scenes[\"Title\"].mainMenu();\r\n  }\r\n\r\n  addText(name,text){\r\n    this.text=new Infotxt(text[this.game.activeLanguage],this.game.settings.Text.ButtonStyle);\r\n    this.container.addChild(this.text);\r\n  }\r\n}\r\n\r\nexport default Confirmation;\r\n","import Scene from './scene.js';\r\nimport MainMenu from './mainmenu.js'\r\nimport Options from './options.js'\r\nimport Help from './help.js'\r\nimport Credits from './credits.js'\r\nimport Confirmation from './confirmation.js'\r\n\r\nclass Title extends Scene{\r\n  build(){\r\n    this.states={};\r\n\r\n    //Add Menus\r\n    this.addState(\"MainMenu\", new MainMenu());\r\n    this.addState(\"Options\", new Options());\r\n    this.addState(\"Credits\", new Credits());\r\n    this.addState(\"Help\", new Help());\r\n    this.addState(\"Warning\", new Confirmation());\r\n\r\n    //Add actions to the menu buttons\r\n    this.addAction(\"MainMenu\",\"Options\",this.showOptions.bind(this));\r\n    this.addAction(\"MainMenu\",\"Help\",this.showHelp.bind(this));\r\n    this.addAction(\"MainMenu\",\"Credits\",this.showCredits.bind(this));\r\n\r\n    this.addAction(\"MainMenu\",\"New\",this.checkAdventure.bind(this));\r\n    this.addAction(\"MainMenu\",\"Continue\",this.loadAdventure.bind(this));\r\n\r\n    this.addAction(\"Warning\",\"Yes\",this.newAdventure.bind(this));\r\n    this.addAction(\"Warning\",\"No\",this.mainMenu.bind(this));\r\n\r\n    this.addAction(\"Options\", \"Back\",this.mainMenu.bind(this));\r\n\r\n  }\r\n\r\n  addAction(name,button,action){\r\n    this.states[name].buttons[button].on('pointerup',action)\r\n  }\r\n\r\n  addState(name, state, config) {\r\n      this.states[name] = state;\r\n\r\n      //Set game so state can access it\r\n      state.game = this.game;\r\n\r\n      //Create state\r\n      state.create();\r\n\r\n      this.container.addChild(this.states[name].container);\r\n  }\r\n\r\n  showOptions(){\r\n    this.states[\"MainMenu\"].hide();\r\n    this.states[\"Options\"].show();\r\n  }\r\n\r\n  showHelp(){\r\n    this.states[\"MainMenu\"].hide();\r\n    this.states[\"Help\"].show();\r\n  }\r\n\r\n  showCredits(){\r\n    this.states[\"MainMenu\"].hide();\r\n    this.states[\"Credits\"].show();\r\n  }\r\n\r\n  mainMenu(){\r\n    this.states[\"Credits\"].hide();\r\n    this.states[\"Options\"].hide();\r\n    this.states[\"Help\"].hide();\r\n    this.states[\"Warning\"].hide();\r\n    this.changeLanguage();\r\n    this.states[\"MainMenu\"].show();\r\n\r\n  }\r\n\r\n  changeLanguage(){\r\n    this.states[\"MainMenu\"].changeLanguage();\r\n    this.states[\"Credits\"].changeLanguage();\r\n    this.states[\"Help\"].changeLanguage();\r\n    this.states[\"Warning\"].changeLanguage();\r\n  }\r\n\r\n  warning(){\r\n    this.states[\"MainMenu\"].hide();\r\n    this.states[\"Warning\"].show();\r\n  }\r\n\r\n  checkAdventure(){\r\n    if(this.game.storage.progress!==undefined){\r\n      this.warning();\r\n    }else{\r\n      this.newAdventure();\r\n    }\r\n  }\r\n\r\n  newAdventure(){\r\n    //Delete any game progress\r\n    this.game.storage.delete();\r\n\r\n    //Set the first scene\r\n    this.game.changeScene(this.game.settings.FirstScene);\r\n\r\n    //Here we go\r\n    this.game.start();\r\n\r\n  }\r\n\r\n  loadAdventure(){\r\n    this.game.storage.load();\r\n    this.game.changeScene(this.game.storage.progress.latestScene);\r\n    this.game.start();\r\n  }\r\n}\r\n\r\nexport default Title;\r\n","//import * as PIXI from 'pixi.js';\r\nimport Scene from './scene.js';\r\n\r\nimport Walkable from 'walkable';\r\n\r\nclass GameScene extends Scene{\r\n  build(){\r\n    if(this.foreground!==undefined) this.foreground.parentLayer = this.game.layerTop; //Z-order\r\n    this.background.parentLayer = this.game.layerBottom; //Z-order\r\n    this.background.interactive=true;\r\n    this.background.buttonMode=true;\r\n\r\n    this.background.on('pointertap',this.getPosition.bind(this));\r\n\r\n    //Add obstacles to the scene\r\n    this.walkable=new Walkable(this.game.width,this.game.height);\r\n      if(this.config.WalkArea!==undefined){\r\n        this.walkable.addPolygon(this.config.WalkArea);\r\n      }\r\n\r\n      if(this.config.Obstacles!==undefined){\r\n        let obstacles=Object.values(this.config.Obstacles);\r\n        this.config.Obstacles=obstacles;\r\n        for(let i=0;i<this.config.Obstacles.length;i++){\r\n          this.walkable.addPolygon(this.config.Obstacles[i]);\r\n        }\r\n      }\r\n\r\n      //Add objects to the scene\r\n      let sceneObjects=this.config.Objects;\r\n      if(sceneObjects){\r\n        for(let i=0;i<sceneObjects.length;i++){\r\n          if(this.game.objects[sceneObjects[i]]!==undefined){\r\n            this.container.addChild(this.game.objects[sceneObjects[i]].sprite);\r\n          }else{\r\n            console.log(\"Error:Game object \"+sceneObjects[i]+\" not found\");\r\n          }\r\n        }\r\n      }\r\n\r\n      //Add NPCs (non-playable characters) to the scene\r\n      let sceneChars=this.config.Characters;\r\n      if(sceneChars){\r\n        for(let i=0;i<sceneChars.length;i++){\r\n          if(this.game.npcs[sceneChars[i]]!==undefined){\r\n            this.container.addChild(this.game.npcs[sceneChars[i]].sprite);\r\n          }else{\r\n            console.log(\"Error:Game character \"+sceneChars[i]+\" not found\");\r\n          }\r\n        }\r\n      }\r\n  }\r\n\r\n  getPosition(event){\r\n    let coord=event.data.getLocalPosition(this.game.app.stage);\r\n    if(!this.game.player.lock && this.game.activeObject===null){\r\n      this.game.player.move(coord);\r\n    }\r\n  }\r\n\r\n  getPath(fromX,fromY,toX,toY){\r\n    return this.walkable.findPath(fromX, fromY, toX, toY, 0);\r\n  }\r\n\r\n}\r\n\r\nexport default GameScene;\r\n","import { TweenMax } from \"gsap\";\r\nimport PixiPlugin from \"gsap/PixiPlugin\";\r\n//import Music from './music.js';\r\n\r\nclass CutScene{\r\n  constructor(){\r\n    this.container=new PIXI.Container();\r\n    this.music=null;\r\n    this.sequenceIndex=0;\r\n    this.played=false;\r\n  }\r\n\r\n  build(){\r\n    if(this.config.Video){\r\n      this.videoData = this.game.files.resources[this.config.Video].data;\r\n      this.videoEnds=this.end.bind(this);\r\n      this.videoData.addEventListener('ended',this.videoEnds);\r\n    }else if(this.config.Sequence){\r\n      this.tween=null;\r\n      this.image=new PIXI.Sprite(PIXI.Texture.from(this.config.Sequence[this.sequenceIndex].Image));\r\n      this.image.anchor.set(0.5,0);\r\n      this.container.interactive=true;\r\n      this.container.buttonMode=true;\r\n      this.container.on('pointertap',this.next.bind(this));\r\n      this.container.addChild(this.image);\r\n      this.field=new PIXI.extras.BitmapText(this.config.Sequence[this.sequenceIndex].Text[this.game.activeLanguage],this.game.settings.Text.Style);\r\n      this.field.anchor.set(0.5,1);\r\n      this.field.maxWidth=this.game.width;\r\n      this.container.addChild(this.field);\r\n    }\r\n  }\r\n\r\n  show(){\r\n    if(this.config.Video) {\r\n      let videoTexture = PIXI.Texture.from(this.videoData);\r\n    \tthis.videoSprite = new PIXI.Sprite(videoTexture);\r\n      this.videoSprite.width = this.game.width;\r\n      this.videoSprite.height = this.game.height;\r\n      this.videoSprite.interactive=true;\r\n      this.videoSprite.buttonMode=true;\r\n      this.videoSprite.on('pointertap',this.end.bind(this));\r\n      this.container.addChild(this.videoSprite);\r\n    }else if(this.config.Sequence) {\r\n      this.adjust();\r\n      this.sound();\r\n    }\r\n    this.game.app.stage.addChild(this.container);\r\n    this.fadeIn();\r\n\r\n  }\r\n\r\n  hide(){\r\n      this.container.parent.removeChild(this.container);\r\n  }\r\n\r\n  next(){\r\n    if(this.timeoutID) clearTimeout(this.timeoutID);\r\n    if(this.sequenceIndex<this.config.Sequence.length-1){\r\n      this.sequenceIndex+=1;\r\n      this.field.text=this.config.Sequence[this.sequenceIndex].Text[this.game.activeLanguage];\r\n      this.image.texture=(PIXI.Texture.from(this.config.Sequence[this.sequenceIndex].Image));\r\n      this.adjust();\r\n      this.fadeIn();\r\n      this.sound();\r\n    }else{\r\n      this.end();\r\n    }\r\n  }\r\n\r\n  fadeIn(){\r\n    if(this.tween) this.tween.kill();\r\n    this.tween=TweenMax.fromTo(this.container, 1, {alpha:0}, {alpha:1, onComplete:this.timer.bind(this)});\r\n  }\r\n\r\n  timer(){\r\n    this.timeoutID = setTimeout(this.fadeOut.bind(this), this.config.Sequence[this.sequenceIndex].Time*1000);\r\n  }\r\n\r\n  fadeOut(){\r\n    if(this.tween) this.tween.kill();\r\n    this.tween=TweenMax.fromTo(this.container, 1, {alpha:1}, {alpha:0, onComplete:this.next.bind(this)});\r\n  }\r\n\r\n  end(){\r\n    this.game.activeCutscene=null;\r\n    if(this.videoData){\r\n      this.videoData.pause();\r\n      this.videoData.removeEventListener('ended',this.videoEnds);\r\n    }\r\n\r\n    if(this.tween) this.tween.kill();\r\n    if(this.timeoutID) clearTimeout(this.timeoutID);\r\n\r\n    if(this.music!==null){\r\n      this.game.sound.stop(this.music);\r\n    }\r\n\r\n    this.played=true;\r\n    this.hide();\r\n\r\n    if(!this.game.finished)\r\n    {\r\n      this.game.resume();\r\n    }else{\r\n      this.game.home();\r\n    }\r\n  }\r\n\r\n  adjust(){\r\n    let ratio=this.image.width / this.image.height;\r\n    this.image.height=this.game.height-this.field.height;\r\n    this.image.width=this.image.height*ratio;\r\n\r\n    this.image.x=this.game.width/2;\r\n    this.field.x=this.game.width/2;\r\n    this.field.y=this.game.height;\r\n\r\n    if(this.container.width>this.game.width || this.container.height>this.game.height){\r\n      this.scale();\r\n    }\r\n    this.center();\r\n  }\r\n\r\n  center(){\r\n    this.container.x = this.game.width / 2;\r\n    this.container.y = this.game.height  / 2;\r\n    this.container.pivot.x = this.container.width / 2;\r\n    this.container.pivot.y = this.container.height / 2;\r\n  }\r\n\r\n  scale(){\r\n    let ratio = Math.min( this.game.width/this.container.width, this.game.height/this.container.height);\r\n    this.container.scale.set(ratio);\r\n  }\r\n\r\n  sound(){\r\n    if(this.config.Sequence[this.sequenceIndex].Music!==undefined && this.game.playSounds){\r\n      if(this.music!==null){\r\n        this.game.sound.stop(this.music);\r\n      }\r\n      \r\n      this.music=this.config.Sequence[this.sequenceIndex].Music;\r\n      this.game.sound.play(this.music);\r\n    }\r\n  }\r\n\r\n}\r\n\r\nexport default CutScene;\r\n","import * as PolyK from 'polyk';\r\n\r\nfunction boxesIntersect(a, b)\r\n{\r\n  var ab = a.getBounds();\r\n  var bb = b.getBounds();\r\n  return ab.x + ab.width > bb.x && ab.x < bb.x + bb.width && ab.y + ab.height > bb.y && ab.y < bb.y + bb.height;\r\n}\r\n\r\nfunction collision(a, b)\r\n{\r\n  let result;\r\n  if(a!=undefined && b !=undefined){\r\n    if(a.hitArea) result=PolyK.ContainsPoint(a.hitArea.points,b.x,b.y);\r\n    else if(b.hitArea) result=PolyK.ContainsPoint(b.hitArea.points,a.x,a.y);\r\n    else result=boxesIntersect(a,b);\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\nfunction closestPoint(area,coords){\r\n  let coordX=Math.round(coords.x);\r\n  let coordY=Math.round(coords.y);\r\n  let changePosition={};\r\n  let closestedge=PolyK.ClosestEdge(area,coordX,coordY);\r\n  changePosition.x=closestedge.point.x-closestedge.norm.x;\r\n  changePosition.y=closestedge.point.y-closestedge.norm.y;\r\n  return {x:Math.round(changePosition.x),y:Math.round(changePosition.y)}\r\n}\r\n\r\nfunction checkPath(coords,obstaclesPolys,walkPoly){\r\n  let coordX=Math.round(coords.x);\r\n  let coordY=Math.round(coords.y);\r\n  let changePosition={};\r\n  let newPos;\r\n\r\n  if(!PolyK.ContainsPoint(walkPoly,coordX,coordY))\r\n  {\r\n    let closestedge=PolyK.ClosestEdge(walkPoly,coordX,coordY);\r\n    changePosition.x=closestedge.point.x-closestedge.norm.x;\r\n    changePosition.y=closestedge.point.y-closestedge.norm.y;\r\n    newPos={x:Math.round(changePosition.x),y:Math.round(changePosition.y)}\r\n  }else if(obstaclesPolys!==undefined){\r\n\r\n    for(let i=0;i<obstaclesPolys.length ;i++){\r\n      if(PolyK.ContainsPoint(obstaclesPolys[i],coordX,coordY)){\r\n        let closestedge=PolyK.ClosestEdge(walkPoly,coordX,coordY);\r\n        changePosition.x=closestedge.point.x-closestedge.norm.x;\r\n        changePosition.y=closestedge.point.y-closestedge.norm.y;\r\n        newPos={x:Math.round(changePosition.x)+1,y:Math.round(changePosition.y)+1};\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  return newPos;\r\n}\r\n\r\nexport {boxesIntersect,checkPath,collision,closestPoint};\r\n","import {boxesIntersect,collision,closestPoint} from '../collisions.js';\r\n\r\nclass GameObject{\r\n  constructor(){\r\n    this.sprite=null;\r\n    this.game=null;\r\n    this.action=null;\r\n  }\r\n\r\n  build(){\r\n    if(this.config.Description===undefined){\r\n      this.config.Description=this.game.data.texts.NoDescription;\r\n    }\r\n    //Configure the sprite's object\r\n    if(this.config.Texture){\r\n      //Generate a static object from a texture\r\n      this.sprite=new PIXI.Sprite.from(PIXI.Texture.from(this.config.Texture));\r\n\r\n    }else if(this.config.Area){\r\n\r\n      //For invisible objects\r\n      this.sprite=new PIXI.Sprite.from(PIXI.Texture.EMPTY);\r\n      this.sprite.hitArea=new PIXI.Polygon(this.config.Area);\r\n\r\n    }else if(this.config.Animation){\r\n\r\n      //Animated objects\r\n      let spritesheet=this.game.files.resources[this.config.Animation.Name].spritesheet;\r\n\r\n      let frames = [];\r\n      for (var i = 0; i < spritesheet._frameKeys.length; i++) {\r\n          frames.push(PIXI.Texture.from(spritesheet._frameKeys[i]));\r\n      }\r\n\r\n      this.sprite=new PIXI.extras.AnimatedSprite(frames);\r\n      this.animationSpeed=this.config.Animation.Speed;\r\n      this.play();\r\n    }\r\n\r\n    //Position of the object in the screen\r\n    if(this.config.Position){\r\n      this.sprite.x=this.config.Position[0];\r\n      this.sprite.y=this.config.Position[1];\r\n    }\r\n\r\n    //Size of the object\r\n    if(this.config.Size){\r\n      this.sprite.scale.set(this.config.Size)\r\n    }\r\n\r\n    if(this.config.Mirror){\r\n      this.flip();\r\n    }\r\n\r\n    //Configure the anchor (origin point of the object)\r\n    if(!this.config.Area)this.sprite.anchor.set(0.5,1);\r\n\r\n    //Configure the layer for the z-order\r\n    if(this.config.Layer===\"Top\") this.sprite.parentLayer=this.game.layerTop;\r\n    else if(this.config.Layer===\"Bottom\") this.sprite.parentLayer=this.game.layerBottom;\r\n    else this.sprite.parentLayer = this.game.layer;\r\n\r\n    //Is it a door?\r\n    if(this.config.Door){\r\n      this.door=true;\r\n      this.newScene=this.config.Door.To;\r\n      this.playerPos=this.config.Door.Player;\r\n    }\r\nthis.holding=false;\r\nthis.timeoutID;\r\n    if(this.config.Lock){\r\n      this.locked=true;\r\n    }\r\n    //Game object events\r\n    this.sprite.interactive=true;\r\n    this.sprite.buttonMode=true;\r\n\r\n    if(this.config.Area!==undefined){\r\n      this.sprite.on('pointerdown', this.touchArea.bind(this))\r\n          .on('pointerup', this.releaseArea.bind(this))\r\n          .on('pointerupoutside', this.releaseArea.bind(this));\r\n    }else{\r\n      this.sprite.on('pointerdown', this.touch.bind(this))\r\n          .on('pointermove', this.move.bind(this))\r\n          .on('pointerup', this.release.bind(this))\r\n          .on('pointerupoutside', this.release.bind(this));\r\n    }\r\n\r\n    if(this.config.Interactive!==undefined) this.setInteraction(this.config.Interactive);\r\n  }\r\n\r\n  hide(){\r\n    this.sprite.visible=false;\r\n  }\r\n\r\n  show(){\r\n    this.sprite.visible=true;\r\n  }\r\n\r\n  setpos(x,y){\r\n    this.sprite.x=x;\r\n    this.sprite.y=y;\r\n  }\r\n\r\n  flip(){\r\n    this.sprite.scale.x*=-1;\r\n  }\r\n\r\n  changeTexture(texture){\r\n    this.sprite.texture=new PIXI.Texture.from(texture)\r\n  }\r\n\r\n  hold(){\r\n    this.holding=true;\r\n  }\r\n  //Invisible object touch begins\r\n  touchArea(event){\r\n    if(this.game.activeObject===null && !this.game.player.lock){\r\n      this.game.activeObject=this;\r\n      this.interaction = event.data;\r\n      this.action=null;\r\n      if(this.timeoutID) clearTimeout(this.timeoutID);\r\n      this.timeoutID=setTimeout(this.hold.bind(this), this.game.holdTime);\r\n      this.touchedPos=this.interaction.getLocalPosition(this.game.app.stage);\r\n    }\r\n  }\r\n\r\n  //Invisible object touch ends\r\n  releaseArea(){\r\n    if(this.timeoutID) clearTimeout(this.timeoutID);\r\n\r\n    if(this.interaction){\r\n      let moveTo=this.interaction.getLocalPosition(this.game.app.stage);\r\n      if(collision(moveTo,this.sprite)){\r\n        if(this.interaction.button===2 || this.holding){\r\n          if(this.door===true ){\r\n            let newPos=closestPoint(this.config.Area,moveTo);\r\n            moveTo=newPos;\r\n          }else if(this.config.Use!==undefined){\r\n            this.game.activePuzzle=this.game.puzzles[this.config.Use];\r\n          }\r\n          this.action=\"Use\";\r\n        }else{\r\n          this.action=\"Look\";\r\n       }\r\n      }\r\n\r\n      if(this.action!==null){\r\n        this.game.player.endAction=this.action;\r\n        this.game.player.move(moveTo);\r\n      }else{\r\n        this.cancel();\r\n      }\r\n\r\n      if(this.game.player.touched) this.game.player.touched=false;\r\n      this.holding=false;\r\n      this.interaction = null;\r\n      this.touchedPos=null;\r\n    }\r\n  }\r\n\r\n  //Object touch begins\r\n  touch(event){\r\n    if(this.game.activeObject===null && !this.game.player.lock){\r\n      this.game.activeObject=this;\r\n      this.action=null;\r\n      this.posX = this.sprite.x;\r\n      this.posY = this.sprite.y;\r\n      this.interaction = event.data;\r\n      this.sprite.alpha = 0.5;\r\n      this.dragging = true;\r\n      if(this.timeoutID) clearTimeout(this.timeoutID);\r\n      this.timeoutID=setTimeout(this.hold.bind(this), 1000);\r\n      this.oldParent=this.sprite.parent;\r\n      this.depthGroup=this.sprite.parentLayer;\r\n      if(this.sprite.parentLayer !== this.game.layerUI) this.sprite.parentLayer = this.game.layerUI;\r\n    }\r\n  }\r\n\r\n  //Object is being dragged\r\n  move(){\r\n    if (this.dragging && !this.locked) {\r\n      this.sprite.setParent(this.game.app.stage);\r\n      var newPosition = this.interaction.getLocalPosition(this.sprite.parent);\r\n      let bounds=this.sprite.getBounds();\r\n      //We can only move the object inside the stage\r\n      if(newPosition.x>bounds.width/2 && newPosition.x<this.game.width-bounds.width/2) this.sprite.x = newPosition.x;\r\n      if(newPosition.y>bounds.height && newPosition.y<this.game.height) this.sprite.y = newPosition.y;\r\n    }\r\n  }\r\n\r\n  //Object drag/touch ends\r\n  release(){\r\n    if(this.timeoutID) clearTimeout(this.timeoutID);\r\n\r\n    if(this.interaction){\r\n      let moveTo={x:this.posX,y:this.posY};\r\n      //Check if we take it\r\n      if(collision(this.sprite,this.game.inventory.icon) && this.config.Take){\r\n        this.action=\"Take\";\r\n        //Check if we look it\r\n      }else if(this.interaction.button===2  || this.holding){\r\n        if(this.config.Use!==undefined) this.game.activePuzzle=this.game.puzzles[this.config.Use];\r\n        this.action=\"Use\";\r\n      }else{\r\n        this.action=\"Look\";\r\n      }\r\n\r\n      if(this.action!==null){\r\n        this.game.player.endAction=this.action;\r\n        this.game.player.move(moveTo);\r\n      }else{\r\n        this.cancel();\r\n      }\r\n\r\n      if(this.game.player.touched) this.game.player.touched=false;\r\n\r\n      this.sprite.x = this.posX;\r\n      this.sprite.y = this.posY;\r\n      this.sprite.alpha = 1;\r\n      this.sprite.parentLayer = this.depthGroup;\r\n      this.sprite.setParent(this.oldParent);\r\n\r\n      this.holding=false;\r\n      this.interaction = null;\r\n      this.dragging = false;\r\n    }\r\n  }\r\n\r\n  //Check collision between objects\r\n  hit(){\r\n    let found=null;\r\n    let i;\r\n\r\n    //First check the collision between active scene's objects\r\n    let objectsArray=this.game.activeScene.config.Objects;\r\n    if(objectsArray!==undefined){\r\n      for(i=0;i<objectsArray.length;i++){\r\n        if(collision(this.sprite,this.game.objects[objectsArray[i]].sprite)\r\n                     && this.config.Name!==objectsArray[i]){\r\n          found=objectsArray[i];\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    //Check if the collision is between inventory objects\r\n    objectsArray=this.game.inventory.objects;\r\n\r\n    for(i=0;i<objectsArray.length;i++){\r\n      if(collision(this.sprite,this.game.objects[objectsArray[i]].sprite)\r\n                   && this.config.Name!==objectsArray[i]){\r\n        found=objectsArray[i];\r\n        break;\r\n      }\r\n    }\r\n\r\n    //Check the collision a character\r\n    let charsArray=this.game.activeScene.config.Characters;\r\n    if(charsArray!==undefined){\r\n      for(i=0;i<charsArray.length;i++){\r\n        if(collision(this.sprite,this.game.npcs[charsArray[i]].sprite)\r\n                     && this.config.Name!==charsArray[i]){\r\n          found=charsArray[i];\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    return found;\r\n  }\r\n\r\n  //Object action is canceled or ended\r\n  cancel(){\r\n    this.game.activeObject.action=null;\r\n    this.game.activeObject=null;\r\n\r\n  }\r\n\r\n  setInteraction(value){\r\n    this.sprite.interactive=value;\r\n  }\r\n\r\n  //Add the object to a given scene\r\n  add(scene){\r\n    this.game.scenes[scene].container.addChild(this.sprite);\r\n    this.game.scenes[scene].config.Objects.push(this.config.Name);\r\n  }\r\n  //Remove objects from game\r\n  remove(){\r\n    this.sprite.parent.removeChild(this.sprite);\r\n\r\n    //Check if we remove an object which is in an scene\r\n    let scenesArray=Object.values(this.game.scenes)\r\n    let i;\r\n    let scenesLength=scenesArray.length;\r\n    for(i=0;i<scenesLength;i++){\r\n      if(scenesArray[i].config.Objects!==undefined && scenesArray[i].config.Objects.includes(this.config.Name)){\r\n        let tmpIndex=scenesArray[i].config.Objects.indexOf(this.config.Name);\r\n        scenesArray[i].config.Objects.splice(tmpIndex,1);\r\n      }\r\n    }\r\n\r\n    //Check if the object to remove is inside the inventory\r\n    if(this.game.inventory.objects.includes(this.config.Name)){\r\n      this.game.inventory.remove(this.config.Name)\r\n    }\r\n  }\r\n\r\n}\r\n\r\nexport default GameObject;\r\n","import {boxesIntersect,collision} from '../collisions.js';\r\n\r\nclass Inventory{\r\n  constructor(){\r\n      this.container=new PIXI.Container();\r\n      this.container.visible=false;\r\n      this.game=null;\r\n      this.objects=[];\r\n\r\n    }\r\n\r\n    build(){\r\n      this.background=new PIXI.Sprite(PIXI.Texture.from(this.game.settings.Inventory.Background));\r\n      this.background.width=this.game.width/2;\r\n      this.background.height=this.game.height/2;\r\n      this.background.parentLayer = this.game.layerUI;\r\n      this.container.x = (this.game.width - this.background.width) / 2;\r\n      this.container.y = (this.game.height - this.background.height) / 2;\r\n      this.border=10;\r\n      this.icon=new PIXI.Sprite(PIXI.Texture.from(this.game.settings.Inventory.Icon));\r\n      this.icon.on('pointertap',this.click.bind(this));\r\n      this.icon.interactive=true;\r\n      this.icon.buttonMode=true;\r\n      this.setIcon(this.game.settings.Inventory.Position);\r\n      this.container.addChild(this.background);\r\n      this.icon.parentLayer = this.game.layerUI;\r\n\r\n      //Hidden by default\r\n      this.hide();\r\n      this.hideIcon();\r\n    }\r\n\r\n    show(){\r\n      this.update();\r\n      this.container.visible=true;\r\n    }\r\n\r\n    hide(){\r\n      this.container.visible=false;\r\n\r\n    }\r\n\r\n    showIcon(){\r\n      this.icon.visible=true;\r\n    }\r\n\r\n    hideIcon(){\r\n      this.icon.visible=false;\r\n\r\n    }\r\n\r\n    setIcon(position){\r\n      if(position==\"bottom-right\"){\r\n        this.icon.x=this.game.width - this.icon.width;\r\n        this.icon.y=this.game.height - this.icon.height;\r\n      }else if(position==\"top-right\"){\r\n        this.icon.x=this.game.width - this.icon.width;\r\n        this.icon.y=0;\r\n      }else if(position==\"top-left\"){\r\n        this.icon.x=0;\r\n        this.icon.y=this.game.height - this.icon.height;\r\n      }else if(position==\"bottom-top\"){\r\n        this.icon.x=this.game.width - this.icon.width;\r\n        this.icon.y=0;\r\n      }\r\n    }\r\n\r\n    click(){\r\n      if (this.container.visible) this.hide();\r\n      else if(!this.game.player.lock) this.show();\r\n    }\r\n\r\n    add(name){\r\n      this.objects.push(name);\r\n      this.game.objects[name].sprite.setParent(this.container);\r\n      this.game.objects[name].sprite.parentLayer=this.game.layerUI;\r\n      this.game.objects[name].sprite.on('pointermove', this.move.bind(this.game.objects[name]))\r\n                                    .off('pointerup')\r\n                                    .off('pointerupoutside')\r\n                                    .on('pointerup',this.release.bind(this.game.objects[name]))\r\n                                    .on('pointerupoutside',this.release.bind(this.game.objects[name]));\r\n      this.update();\r\n    }\r\n\r\n    remove(name)\r\n    {\r\n      //Check if object is already in inventory\r\n      if(this.objects.includes(name)){\r\n        this.objects.splice(this.objects.indexOf(name),1);\r\n        this.update();\r\n      }\r\n    }\r\n\r\n    update(){\r\n      //Inventory is limited to 25 objects\r\n      let i;\r\n      let numObjs=this.objects.length;\r\n      for(i=0;i<numObjs;i++){\r\n        let tmpObj=this.game.objects[this.objects[i]].sprite;\r\n\r\n        let desiredWidth=this.container.width/5-this.container.width*0.05;\r\n        let desiredHeight=this.container.height/5-this.container.height*0.05;\r\n        let ratio = Math.min( desiredWidth/tmpObj.width, desiredHeight/tmpObj.height);\r\n        tmpObj.width*=ratio;\r\n        tmpObj.height*=ratio;\r\n\r\n        tmpObj.x = ((i % 5) * this.container.width/5+this.border-i)+tmpObj.width/2;\r\n        tmpObj.y = (Math.floor(i / 5) * this.container.height/5+this.border-i)+tmpObj.height;\r\n        this.container.width=this.background.width;\r\n        this.container.height=this.background.height;\r\n      }\r\n    }\r\n\r\n    move(){\r\n      if(!boxesIntersect(this.sprite,this.game.inventory.container))\r\n        this.game.inventory.hide();\r\n    }\r\n\r\n    release(event){\r\n      if(this.timeoutID) clearTimeout(this.timeoutID);\r\n\r\n      if(this.interaction){\r\n        let objectHit=this.hit();\r\n\r\n        let moveTo={x:this.sprite.x,y:this.sprite.y};\r\n        //Check if we take it\r\n        if(!this.holding){\r\n          this.game.player.say(this.config.Description[this.game.activeLanguage])\r\n        }else if(this.config.Combine!==undefined && objectHit!==null){\r\n          if(this.config.Combine.With===objectHit) {\r\n            this.game.activePuzzle=this.game.puzzles[this.config.Combine.Puzzle];\r\n          }\r\n          this.action=\"Use\";\r\n        }\r\n\r\n        if(this.action!==null){\r\n          this.game.player.endAction=this.action;\r\n          this.game.player.move(moveTo);\r\n        }else{\r\n          this.cancel();\r\n        }\r\n\r\n        this.sprite.x = this.posX;\r\n        this.sprite.y = this.posY;\r\n        this.sprite.alpha = 1;\r\n        this.sprite.setParent(this.oldParent);\r\n\r\n        this.interaction = null;\r\n        this.dragging = false;\r\n        this.holding=false;\r\n      }\r\n    }\r\n}\r\n\r\nexport default Inventory;\r\n","class Puzzle{\r\n  constructor(){\r\n    this.solved=false;\r\n  }\r\n\r\n  resolve(){\r\n    if(this.game.activeObject!==null) this.game.activeObject.cancel();\r\n\r\n    if(!this.solved){\r\n      if(this.config.ModifyObject){\r\n        let objectMod=this.game.objects[this.config.ModifyObject.Name];\r\n        if(this.config.ModifyObject.Description!==undefined) objectMod.config.Description=this.config.ModifyObject.Description;\r\n        if(this.config.ModifyObject.Door!==undefined) this.createDoor(objectMod)\r\n        if(this.config.ModifyObject.Position!==undefined) objectMod.setpos(this.config.ModifyObject.Position[0],this.config.ModifyObject.Position[1]);\r\n        if(this.config.ModifyObject.Mirror) objectMod.flip();\r\n        if(this.config.ModifyObject.Interactive!==undefined) this.setInteraction(this.config.ModifyObject.Interactive);\r\n        if(this.config.ModifyObject.Texture!==undefined) this.changeTexture(this.config.ModifyObject.Texture);\r\n        if(this.config.ModifyObject.Combine!==undefined) objectMod.config.Combine=this.config.ModifyObject.Combine;\r\n        if(this.config.ModifyObject.Use!==undefined) objectMod.config.Use=this.config.ModifyObject.Use;\r\n        if(this.config.ModifyObject.Lock!==undefined) objectMod.lock=this.config.ModifyObject.Lock;\r\n      }\r\n\r\n      if(this.config.GetObject!==undefined) this.game.inventory.add(this.config.GetObject);\r\n\r\n      if(this.config.AddObject!==undefined){\r\n        let objectAdd=this.game.objects[this.config.AddObject.Name];\r\n        objectAdd.add(this.config.AddObject.Scene);\r\n      }\r\n\r\n      if(this.config.RemoveObject!==undefined){\r\n        let objectRemove=this.game.objects[this.config.RemoveObject];\r\n        objectRemove.remove();\r\n\r\n      }\r\n\r\n      if(this.config.RemoveDoor!==undefined){\r\n        let objectDoor=this.game.objects[this.config.RemoveDoor];\r\n        objectDoor.door=false;\r\n      }\r\n\r\n      if(this.config.SetDialogue!==undefined){\r\n        this.game.npcs[this.config.SetDialogue.Character].config.Dialogue=this.config.SetDialogue.Dialogue;\r\n      }\r\n\r\n      if(this.config.Resolve!==undefined)this.game.puzzles[this.config.Resolve].resolve();\r\n\r\n      if(this.config.Say && !this.game.silentMode){\r\n        this.game.player.say(this.config.Say[this.game.activeLanguage]);\r\n      }else if(this.config.NPCSay && !this.game.silentMode){\r\n        this.game.npcs[this.config.NPCSay.Name].say(this.config.NPCSay.Text[this.game.activeLanguage]);\r\n      }else{\r\n        this.game.player.stop();\r\n      }\r\n\r\n      if(this.config.Sound!==undefined && !this.game.silentMode){\r\n          this.game.sounds.play(this.config.Sound);\r\n      }\r\n\r\n      if(this.config.CutScene!==undefined && !this.game.silentMode && this.game.playSounds){\r\n        this.game.activeCutscene=this.game.cutscenes[this.config.CutScene];\r\n        this.game.pause();\r\n        this.game.activeCutscene.show();\r\n      }\r\n\r\n      if(this.config.EndGame!==undefined && !this.game.silentMode){\r\n        this.game.end();\r\n        if(this.config.EndGame.CutScene!==undefined){\r\n           this.game.activeCutscene=this.game.cutscenes[this.config.EndGame.CutScene];\r\n           this.game.pause();\r\n           this.game.activeCutscene.show();\r\n        }\r\n        else this.game.home();\r\n      }\r\n\r\n      this.solved=true;\r\n\r\n    }else{\r\n      this.game.player.stop();\r\n    }\r\n\r\n    this.game.activePuzzle=null;\r\n  }\r\n\r\n  createDoor(target){\r\n    target.door=true;\r\n    target.newScene=this.config.ModifyObject.Door.To;\r\n    target.playerPos=this.config.ModifyObject.Door.Player;\r\n  }\r\n}\r\n\r\nexport default Puzzle;\r\n","import dragonBones from 'pixi-dragonbones';\r\nconst dbfactory=dragonBones.PixiFactory.factory;\r\nimport {checkPath} from '../collisions.js'\r\n\r\nimport { TweenMax } from \"gsap\";\r\nimport PixiPlugin from \"gsap/PixiPlugin\";\r\n\r\nclass Character{\r\n  constructor(){\r\n    this.game=null;\r\n    this.state=null;\r\n    this.lock=false;\r\n    this.endAction=null;\r\n  }\r\n\r\n  setup(config){\r\n    dbfactory.parseDragonBonesData(this.game.files.resources[config.Name+\"Skeleton\"].data);\r\n    dbfactory.parseTextureAtlasData(this.game.files.resources[config.Name+\"Json\"].data,this.game.files.resources[config.Name+\"Tex\"].texture);\r\n    this.sprite = dbfactory.buildArmatureDisplay(config.Armature);\r\n    if(config.Size!==undefined){\r\n      this.size=config.Size;\r\n      this.sprite.scale.set(this.size);\r\n    }else{\r\n      this.size=1;\r\n    }\r\n    this.tween=null;\r\n    if(config.Animations!=undefined)\r\n      this.animations=config.Animations;\r\n    else\r\n      this.animations={\r\n        Stand:\"stand\",\r\n        Walk:\"walk\",\r\n        Take:\"take\",\r\n        Use:\"use\",\r\n        Say:\"speak\"\r\n      };\r\n    this.animate(this.animations.Stand);\r\n    this.state=\"stand\";\r\n    if(config.Position){\r\n      this.sprite.x=config.Position[0];\r\n      this.sprite.y=config.Position[1];\r\n    }\r\n    this.sprite.parentLayer = this.game.layer;//Z-order*/\r\n    this.config=config;\r\n  }\r\n\r\n  hide(){\r\n    this.sprite.visible=false;\r\n  }\r\n\r\n  show(){\r\n    this.sprite.visible=true;\r\n  }\r\n\r\n  position(coords){\r\n    this.sprite.x=coords[0];\r\n    this.sprite.y=coords[1];\r\n  }\r\n\r\n  move(coords){\r\n    let obstacles=this.game.activeScene.config.Obstacles;\r\n    let walkingArea=this.game.activeScene.config.WalkArea;\r\n    let newPosition=coords;\r\n    let closestPosition=checkPath(coords,obstacles,walkingArea);\r\n\r\n    if(closestPosition){\r\n      newPosition=closestPosition;\r\n    }\r\n\r\n    let findPath=this.game.activeScene.walkable.findPath(this.sprite.x,this.sprite.y,newPosition.x,newPosition.y,0);\r\n    let i;\r\n    let finalPath=[];\r\n    for(i=0;i<findPath.length;i++){\r\n      finalPath.push({x:findPath[i],y:findPath[i+1]})\r\n      i++;\r\n    }\r\n\r\n    if(finalPath.length>0){\r\n      let animationTime=Math.abs(this.sprite.x-newPosition.x)+Math.abs(this.sprite.y-newPosition.y);\r\n      animationTime=animationTime/(this.game.width+this.game.height);\r\n      animationTime*=10;\r\n      if(this.config.Speed!==undefined) animationTime/=this.config.Speed;\r\n\r\n      this.animate(this.animations.Walk);\r\n      if(this.sprite.x<newPosition.x) this.sprite.armature.flipX=false;\r\n      else this.sprite.armature.flipX=true;\r\n\r\n      this.game.activeState=this;\r\n\r\n      if(this.tween!==null) this.tween.kill();\r\n      this.tween=TweenMax.to(this.sprite, animationTime, {bezier:finalPath, ease:Linear.easeNone,onComplete:this.stop.bind(this)});\r\n    }\r\n  }\r\n\r\n  update(){\r\n    this.scale();\r\n  }\r\n\r\n  scale(){\r\n    let scaleChar=this.sprite.y/this.game.height*this.size;\r\n    if(scaleChar<this.game.activeScene.config.Depth) scaleChar=this.game.activeScene.config.Depth;\r\n    this.sprite.scale.set(scaleChar);\r\n  }\r\n\r\n  stop(){\r\n    this.animate(this.animations.Stand);\r\n    this.game.activeState=null;\r\n    this.lock=false;\r\n    if(this.endAction!==null){\r\n      if(this.endAction===\"Look\") this.look();\r\n      else if(this.endAction===\"Take\") this.take();\r\n      else if(this.endAction===\"Use\") this.use();\r\n      else if(this.endAction===\"Talk\") this.talk();\r\n      this.endAction=null;\r\n    }\r\n  }\r\n\r\n  say(text){\r\n    this.game.textField.talker=this;\r\n    //Setup the text to show\r\n    this.game.textField.setText(text);\r\n    this.game.textField.setAvatar(this.config.Avatar);\r\n    if(this.config.Color!==undefined) this.game.textField.setColor(Number(this.config.Color));\r\n    if(this.config.Font!==undefined) this.game.textField.setFont(this.config.Font);\r\n    else this.game.textField.setFont(this.game.settings.Text.Style.font)\r\n\r\n    this.game.textField.show();\r\n\r\n    //Animate the character\r\n    this.animate(this.animations.Say);\r\n    if(this.timeoutID) clearTimeout(this.timeoutID);\r\n    this.timeoutID=setTimeout(this.game.textField.end.bind(this.game.textField), this.game.textField.timeOut());\r\n  }\r\n\r\n  shutup(){\r\n    this.animate(this.animations.Stand);\r\n  }\r\n\r\n  animate(animation,times){\r\n    if(this.sprite.animation.lastAnimationName!==animation)\r\n      this.sprite.animation.fadeIn(animation,0.25,times);\r\n  }\r\n}\r\n\r\nexport default Character;\r\n","import Character from './character.js';\r\nimport dragonBones from 'dragonbones-pixi';\r\nconst dbEvents=dragonBones.dragonBones.EventObject;\r\nimport {closestPoint} from '../collisions.js';\r\n\r\nclass Player extends Character{\r\n  setup(config){\r\n    super.setup(config);\r\n\r\n    //Hidden by default\r\n    this.hide();\r\n  }\r\n\r\n  checkDirection(target){\r\n    //Player must look in the right direction\r\n    if(target.config.Area===undefined){\r\n      if(this.sprite.x<target.sprite.x){\r\n        this.sprite.armature.flipX=false;\r\n      }else{\r\n        this.sprite.armature.flipX=true;\r\n      }\r\n    }\r\n  }\r\n\r\n  say(text){\r\n    super.say(text);\r\n    //Lock the player\r\n    this.lock=true;\r\n  }\r\n\r\n  look(){\r\n    if(this.game.activeObject!==null){\r\n      this.checkDirection(this.game.activeObject);\r\n      let text=this.game.activeObject.config.Description[this.game.activeLanguage];\r\n      this.say(text);\r\n      this.game.activeObject.cancel();\r\n    }else if(this.game.activeNPC!==null){\r\n      this.checkDirection(this.game.activeNPC);\r\n          let text=this.game.activeNPC.config.Description[this.game.activeLanguage];\r\n          this.say(text);\r\n          this.game.activeNPC.cancel();\r\n    }\r\n  }\r\n\r\n  take(){\r\n    this.lock=true;\r\n    this.animate(this.animations.Take,1);\r\n    this.sprite.once(dbEvents.COMPLETE, this.takeEnd, this);\r\n  }\r\n\r\n  takeEnd(){\r\n    if(this.game.activeObject!==null){\r\n      let name=this.game.activeObject.config.Name;\r\n      if(this.game.activeScene!==null){\r\n        if(this.game.activeScene.config.Objects.includes(name)){\r\n          let tmpIndex=this.game.activeScene.config.Objects.indexOf(name);\r\n          this.game.activeScene.config.Objects.splice(tmpIndex,1);\r\n        }\r\n      }\r\n      this.game.inventory.add(name);\r\n      this.game.activeObject.cancel();\r\n      this.stop();\r\n    }\r\n  }\r\n\r\n  use(){\r\n    this.lock=true;\r\n    this.animate(this.animations.Use,1);\r\n    this.sprite.once(dbEvents.COMPLETE, this.useEnd, this);\r\n  }\r\n\r\n  useEnd(){\r\n    if(this.game.activePuzzle!==null){\r\n      this.game.activePuzzle.resolve();\r\n    }else if(this.game.activeObject!==null) {\r\n      if(this.game.activeObject.door){\r\n        this.game.changeScene(this.game.activeObject.newScene,\r\n          this.game.activeObject.playerPos);\r\n        this.stop();\r\n      }else{\r\n        this.say(this.game.data.texts.NotUsable[this.game.activeLanguage])\r\n      }\r\n      this.game.activeObject.cancel();\r\n    }\r\n  }\r\n\r\n  talk(){\r\n    //Player must look in the right direction\r\n    if(this.sprite.x<this.game.activeNPC.sprite.x){\r\n      this.sprite.armature.flipX=false;\r\n      if(this.game.activeNPC.config.Mirror!==undefined) this.game.activeNPC.sprite.armature.flipX=false;\r\n      else this.game.activeNPC.sprite.armature.flipX=true;\r\n    }else{\r\n      this.sprite.armature.flipX=true;\r\n      if(this.game.activeNPC.config.Mirror!==undefined) this.game.activeNPC.sprite.armature.flipX=true;\r\n      else this.game.activeNPC.sprite.armature.flipX=false;\r\n    }\r\n\r\n    //Let's talk\r\n    this.game.activeDialogue.start();\r\n  }\r\n\r\n}\r\n\r\nexport default Player;\r\n","import Character from './character.js';\r\n\r\nclass NPC extends Character{\r\n  build(){\r\n    if(this.config.Mirror!==undefined) this.sprite.armature.flipX=true;\r\n    this.holding=false;\r\n    this.pressTimeoutID;\r\n    this.sprite.interactive=true;\r\n    this.sprite.buttonMode=true;\r\n    this.sprite.on('pointerdown', this.touch.bind(this))\r\n        .on('pointerup', this.release.bind(this))\r\n        .on('pointerupoutside', this.release.bind(this));\r\n  }\r\n\r\n  hold(){\r\n    this.holding=true;\r\n  }\r\n\r\n  touch(event){\r\n    if(this.game.activeNPC===null && !this.game.player.lock){\r\n      this.game.activeNPC=this;\r\n      this.action=null;\r\n      this.interaction = event.data;\r\n      if(this.pressTimeoutID) clearTimeout(this.pressTimeoutID);\r\n      this.pressTimeoutID=setTimeout(this.hold.bind(this), this.game.holdTime);\r\n    }\r\n  }\r\n  //Object drag/touch ends\r\n  release(){\r\n    if(this.pressTimeoutID) clearTimeout(this.pressTimeoutID);\r\n    if(this.interaction){\r\n      let distance=0;\r\n      if(this.game.player.sprite.x<this.sprite.x) distance=this.sprite.getBounds().width*-1;\r\n      else distance=this.sprite.getBounds().width;\r\n      let moveTo={x:this.sprite.x+distance,y:this.sprite.y};\r\n\r\n      if(this.interaction.button===2  || this.holding){\r\n        //Check if we talk with the character\r\n        if(this.config.Dialogue!==undefined){\r\n          this.game.activeDialogue=this.game.dialogues[this.config.Dialogue];\r\n          this.action=\"Talk\";\r\n        }\r\n      }else{\r\n        this.action=\"Look\";\r\n      }\r\n\r\n      if(this.action!==null){\r\n        this.game.player.endAction=this.action;\r\n        this.game.player.move(moveTo);\r\n      }else{\r\n        this.cancel();\r\n      }\r\n\r\n      if(this.game.player.touched) this.game.player.touched=false;\r\n\r\n      this.holding=false;\r\n      this.interaction = null;\r\n      this.dragging = false;\r\n      this.moved=0;\r\n    }\r\n  }\r\n\r\n  //Set player to look this object\r\n  look(){\r\n    this.action=this.game.player.look.bind(this.game.player);\r\n  }\r\n\r\n  //Object action is canceled or ended\r\n  cancel(){\r\n    this.game.activeNPC.action=null;\r\n    this.game.activeNPC=null;\r\n\r\n  }\r\n}\r\n\r\nexport default NPC;\r\n","import {Button} from './text.js'\r\n\r\n//Branches dialogue system\r\nclass Dialogue{\r\n  constructor(){\r\n    this.timeoutID=null;\r\n    this.firstTime=true;\r\n    this.choice=null;\r\n    this.branches={};\r\n  }\r\n\r\n  setup(config){\r\n    this.config=config;\r\n\r\n    //Get dialogue branches\r\n    let i;\r\n    length=this.config.Branches.length;\r\n    for(i=0;i<length;i++)\r\n    {\r\n      this.branches[this.config.Branches[i].Name]=this.config.Branches[i];\r\n    }\r\n\r\n    this.currentBranch=this.branches[this.config.DefaultBranch];\r\n  }\r\n\r\n  //Executed when we interact with a NPC\r\n  start(){\r\n    this.firstTime=false;\r\n    this.game.player.lock=true;\r\n    this.game.textField.show();\r\n    this.game.textField.hideAvatar();\r\n    this.game.textField.Choices.get();\r\n  }\r\n\r\n  //Executed everytime we choose an option\r\n  next(){\r\n    if(this.choice!==null){\r\n      let choiceSelected=this.currentBranch.Choices[this.choice];\r\n      this.game.textField.Choices.hide();\r\n      this.game.player.say(choiceSelected.Text[this.game.activeLanguage]);\r\n    }else{\r\n      this.game.textField.hideAvatar();\r\n      this.game.textField.Choices.get();\r\n    }\r\n  }\r\n\r\n  //Search for a branch with a given name\r\n  searchBranch(name){\r\n    let branchFound=-1;\r\n    let i;\r\n    let length=this.config.Branches.length\r\n    for(i=0;i<length;i++)\r\n         if(this.config.Branches[i].Name===name)\r\n         {\r\n             branchFound=i;\r\n             break;\r\n         }\r\n    return branchFound;\r\n  }\r\n\r\n  answer(){\r\n    let choiceSelected=this.currentBranch.Choices[this.choice];\r\n    this.game.activeNPC.say(choiceSelected.Answer[this.game.activeLanguage]);\r\n\r\n    if(choiceSelected.Link){\r\n      this.currentBranch=this.branches[choiceSelected.Link];\r\n    }else if(choiceSelected.Puzzle){\r\n      choiceSelected.Repeat=false;\r\n      this.end();\r\n      this.game.puzzles[choiceSelected.Puzzle].resolve();\r\n    }else if(choiceSelected.EndDialogue){\r\n      this.end();\r\n    }\r\n\r\n\r\n    this.choice=null;\r\n  }\r\n\r\n  //Ends the conversations\r\n  end(){\r\n    this.game.activeNPC=null;\r\n    this.game.activeDialogue=null;\r\n  }\r\n\r\n  timeOut(){\r\n    this.next();\r\n  }\r\n}\r\n\r\nexport default Dialogue;\r\n","import { TweenMax } from \"gsap\";\r\nimport PixiPlugin from \"gsap/PixiPlugin\";\r\n\r\nclass Logo{\r\n  constructor(game){\r\n    this.game=game;\r\n    this.index=0;\r\n    this.timeoutID=null;\r\n    this.tween=null;\r\n    this.image=new PIXI.Sprite(\r\n      PIXI.Texture.from(this.game.settings.Logos[this.index]));\r\n    this.image.anchor.set(0.5,0.5)\r\n    this.image.position.set(this.game.width/2,this.game.height/2)\r\n    this.image.interactive=true;\r\n    this.image.buttonMode=true;\r\n    this.image.on('pointertap',this.fadeOut.bind(this));\r\n    this.image.alpha=0;\r\n  }\r\n\r\n  show(){\r\n    this.game.app.stage.addChild(this.image);\r\n    this.fadeIn();\r\n  }\r\n\r\n  fadeIn(){\r\n    if(this.tween) this.tween.kill();\r\n    this.tween=TweenMax.set(this.image,{alpha:0});\r\n    this.tween=TweenMax.fromTo(this.image, 1, {alpha:0}, {alpha:1, onComplete:this.timer.bind(this)});\r\n  }\r\n\r\n  timer(){\r\n    this.timeoutID = setTimeout(this.fadeOut.bind(this), 3*1000);\r\n  }\r\n\r\n  fadeOut(){\r\n    this.image.interactive=false;\r\n    if(this.tween) this.tween.kill();\r\n    this.tween=TweenMax.fromTo(this.image, 1, {alpha:1}, {alpha:0, onComplete:this.next.bind(this)});\r\n  }\r\n\r\n  next(){\r\n    this.image.interactive=true;\r\n    if(this.timeoutID) clearTimeout(this.timeoutID);\r\n    this.index++;\r\n    if(this.game.settings.Logos[this.index]!==undefined)\r\n    {\r\n      this.image.texture=(PIXI.Texture.from\r\n        (this.game.settings.Logos[this.index]));\r\n      this.fadeIn();\r\n    }\r\n    else this.end();\r\n  }\r\n\r\n  end(){\r\n\r\n    if(this.timeoutID) clearTimeout(this.timeoutID);\r\n    if(this.tween) this.tween.kill();\r\n    this.game.app.stage.removeChild(this.image);\r\n\r\n    //Set Title as the first scene to show\r\n    this.game.setScene(this.game.titleLabel);\r\n    this.game.fadeIn();\r\n  }\r\n}\r\n\r\nexport default Logo;\r\n","import * as PIXI from 'pixi.js';\r\nimport 'pixi-layers';\r\nimport { TweenMax } from \"gsap\";\r\nimport PixiPlugin from \"gsap/PixiPlugin\";\r\n\r\nimport Loader from './loader.js';\r\nimport Storage from './storage.js';\r\nimport SoundManager from './soundmanager.js';\r\nimport Title from './class/title.js';\r\nimport GameScene from './class/gamescene.js';\r\nimport CutScene from './class/cutscene.js';\r\nimport GameObject from './class/gameobject.js';\r\nimport Inventory from './class/inventory.js';\r\nimport Puzzle from './class/puzzle.js';\r\nimport {TextField} from './class/text.js';\r\nimport Player from './class/player.js';\r\nimport NPC from './class/npc.js';\r\nimport Dialogue from './class/dialogue.js';\r\nimport Logo from './class/logo.js';\r\n\r\nclass Game {\r\n  constructor(config){\r\n    this.settings={};\r\n    this.data={\r\n      scenes:[],\r\n      cutscenes:[],\r\n      objects:[],\r\n      dialogues:[],\r\n      puzzles:[],\r\n      credits:[],\r\n      texts:[]\r\n    };\r\n    this.width=config.width;\r\n    this.height=config.height;\r\n    this.holdTime=500;\r\n    this.playSounds = true;\r\n\r\n    //Setup the application\r\n    this.app = new PIXI.Application(\r\n      config.width,config.height,{\r\n      antialias: true,\r\n      autoResize: true,\r\n      resolution: devicePixelRatio\r\n    });\r\n\r\n    this.app.stage = new PIXI.display.Stage();\r\n\r\n    //Change game size when window size changes\r\n    if(config.autoResize!==undefined) this.app.renderer.autoResize=config.autoResize;\r\n    else window.addEventListener('resize', this.resize.bind(this));\r\n\r\n    //Disable contextmenu for mouse interaction\r\n    document.addEventListener('contextmenu', e => {\r\n       e.preventDefault();\r\n    });\r\n\r\n    //We append it to a HTML element or Document body\r\n    if(config.parent){\r\n      document.getElementById(config.parent).appendChild(this.app.view)\r\n    }else{\r\n      document.body.appendChild(this.app.view);\r\n    }\r\n\r\n    //Load config files\r\n    this.preload(config.files);\r\n  }\r\n\r\n  //Read JSON configuration files\r\n  preload(files){\r\n    //Text to show progress\r\n    this.progressBar=new PIXI.Graphics();\r\n    this.progressBar.beginFill(0xDE3249);\r\n    this.progressBar.drawRect(0, 0, this.width, this.height/50);\r\n    this.progressBar.endFill();\r\n    this.progressBar.width=0;\r\n\r\n    this.loadingTxt=new PIXI.Text(\"Loading...\", {fill: 'white',\"fontSize\": 50});\r\n    this.loadingTxt.anchor.set(0.5);\r\n    this.loadingTxt.x=this.width/2;\r\n    this.loadingTxt.y=this.height/2;\r\n\r\n    this.progressBar.y=this.height-this.loadingTxt.height;\r\n\r\n    this.app.stage.addChild(this.loadingTxt);\r\n    this.app.stage.addChild(this.progressBar);\r\n    this.resize();\r\n    this.jsons=new Loader();\r\n    this.jsons.game=this;\r\n    this.jsons.addJSON(files);\r\n    this.jsons.load(this.load.bind(this)); //When all config files are loaded, load the game resources.\r\n  }\r\n\r\n  //Load game resources (images,sounds,vids...)\r\n  load(){\r\n    this.files=new Loader();\r\n    this.files.game=this;\r\n    this.files.addFiles(Object.values(this.jsons.resources));\r\n    this.files.load(this.setup.bind(this));\r\n  }\r\n\r\n  setup(){\r\n    this.app.stage.removeChild(this.loadingTxt);\r\n    this.app.stage.removeChild(this.progressBar);\r\n\r\n    //Z-Order\r\n    this.addZOrder();\r\n\r\n    //Adjust to window size\r\n    this.resize();\r\n\r\n    this.tween=null;\r\n    this.logo=null;\r\n    this.sounds=null;\r\n\r\n    this.scenes={};\r\n    this.cutscenes={};\r\n    this.objects={};\r\n    this.npcs={};\r\n    this.dialogues={};\r\n    this.puzzles={};\r\n\r\n\r\n    this.activeLanguage=0;\r\n    this.activeScene=null;\r\n    this.activeObject=null;\r\n    this.activeNPC=null;\r\n    this.activePuzzle=null;\r\n    this.activeDialogue=null;\r\n    this.activeCutscene=null;\r\n\r\n    this.activeState=null;\r\n\r\n    this.finished=false;\r\n\r\n    this.storage=new Storage(this);\r\n    this.logo=new Logo(this);\r\n    this.sound=new SoundManager(this);\r\n\r\n    this.titleLabel=\"Title\";\r\n\r\n\r\n    if(this.settings.HoldTime!==undefined) this.holdTime=this.settings.HoldTime*1000;\r\n    if(this.settings.dialogueChoices!==undefined) this.dialogueChoices=this.settings.dialogueChoices;\r\n    else this.dialogueChoices=3;\r\n    //Setup title screen\r\n    this.addScene(this.titleLabel,new Title(),this.settings.TitleScreen);\r\n\r\n    //Add game objects\r\n    let i;\r\n    let length=this.data.objects.length;\r\n    for(i=0;i<length;i++)\r\n    {\r\n      this.addObject(this.data.objects[i].Name,new GameObject(),this.data.objects[i]);\r\n    }\r\n\r\n    //Non-playable characters\r\n    length=this.data.npc.length;\r\n    for(i=0;i<length;i++)\r\n    {\r\n      this.addNPC(this.data.npc[i].Name,new NPC(),this.data.npc[i]);\r\n    }\r\n\r\n    //Dialogues\r\n    length=this.data.dialogues.length;\r\n    for(i=0;i<length;i++)\r\n    {\r\n      this.addDialogue(this.data.dialogues[i].Name,new Dialogue(),this.data.dialogues[i]);\r\n    }\r\n\r\n    //Add game scenes\r\n    length=this.data.scenes.length;\r\n    for(i=0;i<length;i++)\r\n    {\r\n      this.addScene(this.data.scenes[i].Name,new GameScene(),this.data.scenes[i]);\r\n    }\r\n\r\n    //Add cutscenes\r\n    length=this.data.cutscenes.length;\r\n    for(i=0;i<length;i++)\r\n    {\r\n      this.addCutscene(this.data.cutscenes[i].Name,new CutScene(),this.data.cutscenes[i]);\r\n    }\r\n\r\n    //Puzzles\r\n    length=this.data.puzzles.length;\r\n    for(i=0;i<length;i++)\r\n    {\r\n      this.addPuzzle(this.data.puzzles[i].Name,new Puzzle(),this.data.puzzles[i]);\r\n    }\r\n\r\n    //Add Inventory\r\n    this.addInventory();\r\n\r\n    //Add text field\r\n    this.addTextField();\r\n\r\n    //Add player\r\n    this.addPlayer();\r\n\r\n    //Check if there is a saved game\r\n    this.storage.check();\r\n\r\n    this.addBlackScreen();\r\n\r\n    //Game's loop\r\n    this.app.ticker.add(this.loop.bind(this));\r\n\r\n    this.logo.show();\r\n\r\n  }\r\n\r\n  loop(dt){\r\n    // update current state\r\n    if (this.activeState != null) {\r\n        this.activeState.update(dt);\r\n    }\r\n  }\r\n\r\n  addObject(name, object, config) {\r\n      this.objects[name] = object;\r\n\r\n      //Config the object\r\n      object.config=config;\r\n\r\n      //Set game so object can access it\r\n      object.game = this;\r\n\r\n      //Build object\r\n      object.build();\r\n  }\r\n\r\n  addScene(name, scene, config) {\r\n      this.scenes[name] = scene;\r\n\r\n      //Config the scene\r\n      scene.setup(config);\r\n\r\n      //Set game so scene can access it\r\n      scene.game = this;\r\n\r\n      //Build scene\r\n      scene.build();\r\n  }\r\n\r\n  addCutscene(name, cutscene, config) {\r\n      this.cutscenes[name] = cutscene;\r\n\r\n      //Config the scene\r\n      cutscene.config=config;\r\n\r\n      //Set game so scene can access it\r\n      cutscene.game = this;\r\n\r\n      //Build scene\r\n      cutscene.build();\r\n  }\r\n\r\n  addPuzzle(name, puzzle, config) {\r\n      this.puzzles[name] = puzzle;\r\n\r\n      //Puzzle's config\r\n      puzzle.config=config;\r\n\r\n      //Set game so puzzle can access it\r\n      puzzle.game = this;\r\n  }\r\n\r\n  addZOrder(){\r\n    this.BottomGroup= new PIXI.display.Group(0,false);\r\n    this.sortGroup= new PIXI.display.Group(1, true);\r\n    this.sortGroup.on('sort', function (sprite) {\r\n      sprite.zOrder = -sprite.y;\r\n    });\r\n    this.TopGroup = new PIXI.display.Group(2,false);\r\n    this.UIGroup = new PIXI.display.Group(3,false);\r\n\r\n    this.layerBottom=new PIXI.display.Layer(this.BottomGroup);\r\n    this.layer=new PIXI.display.Layer(this.sortGroup);\r\n    this.layerTop=new PIXI.display.Layer(this.TopGroup);\r\n    this.layerUI=new PIXI.display.Layer(this.UIGroup);\r\n\r\n    this.app.stage.group.enableSort = true;\r\n    this.app.stage.addChild(this.layerBottom);//Z-order\r\n    this.app.stage.addChild(this.layer);//Z-order\r\n    this.app.stage.addChild(this.layerTop);//Z-order\r\n    this.app.stage.addChild(this.layerUI);//Z-order\r\n  }\r\n\r\n  addInventory(){\r\n    this.inventory=new Inventory();\r\n    this.inventory.game=this;\r\n    this.inventory.build();\r\n  }\r\n\r\n  addPlayer(){\r\n    this.player=new Player();\r\n    this.player.game=this;\r\n    this.data.player.Name=\"player\";\r\n    this.player.setup(this.data.player);\r\n  }\r\n\r\n  addNPC(name, char, config){\r\n    this.npcs[name] = char;\r\n\r\n    char.game = this;\r\n\r\n    char.setup(config);\r\n\r\n    char.build();\r\n  }\r\n\r\n  addDialogue(name, dialogue, config){\r\n    this.dialogues[name] = dialogue;\r\n\r\n    dialogue.game = this;\r\n\r\n    dialogue.setup(config);\r\n  }\r\n\r\n  addTextField(){\r\n    this.textField=new TextField();\r\n    this.textField.game=this;\r\n    this.textField.build();\r\n  }\r\n\r\n  //Used for fade between screens\r\n  addBlackScreen(){\r\n    this.blackScreen=new PIXI.Sprite(PIXI.Texture.WHITE);\r\n    this.blackScreen.width=this.width;\r\n    this.blackScreen.height=this.height;\r\n    this.blackScreen.tint=0x000000;\r\n    this.blackScreen.parentLayer = this.layerUI;\r\n  }\r\n\r\n  //Adjust game screen to the window\r\n  resize() {\r\n    var w = window.innerWidth;// * window.devicePixelRatio;\r\n    var h = window.innerHeight;// * window.devicePixelRatio;\r\n    var ratio = Math.min( w/this.width,  h/this.height);\r\n    this.app.renderer.resize(this.width*ratio,this.height*ratio);\r\n    this.app.stage.scale.set(ratio);\r\n\r\n  }\r\n\r\n  //The magic begins\r\n  start(){\r\n    //Show Inventory\r\n    this.app.stage.addChild(this.inventory.container);\r\n    this.app.stage.addChild(this.inventory.icon);\r\n\r\n    //Show Player\r\n    this.app.stage.addChild(this.player.sprite);\r\n\r\n    //Add Text Field\r\n    this.app.stage.addChild(this.textField.container);\r\n  }\r\n\r\n  pause(){\r\n    this.activeScene.hide();\r\n    this.inventory.hide();\r\n    this.inventory.hideIcon();\r\n    this.player.hide();\r\n    if(this.activeScene.music!==undefined){\r\n      this.sound.stop(this.activeScene.music);\r\n    }\r\n  }\r\n\r\n  resume(){\r\n    this.inventory.showIcon();\r\n    this.player.show();\r\n    this.activeScene.show();\r\n    this.fadeIn();\r\n  }\r\n\r\n  end(){\r\n    this.finished=true;\r\n  }\r\n\r\n  home(){\r\n    location.reload();\r\n  }\r\n\r\n  setScene(name,playerCoords) {\r\n    //Remove current container\r\n    if (this.activeScene !== null) {\r\n        this.app.stage.removeChild(this.activeScene.container);\r\n    }\r\n\r\n    //Set current container\r\n    this.activeScene = this.scenes[name];\r\n\r\n    //Player parameters\r\n    if(playerCoords!==undefined){\r\n      this.player.sprite.x=playerCoords[0];\r\n      this.player.sprite.y=playerCoords[1];\r\n    }\r\n\r\n    if(this.activeScene.config.Player!==undefined){\r\n      if(this.activeScene.config.Player.Position!==undefined){\r\n        this.player.position(this.activeScene.config.Player.Position);\r\n      }\r\n      if(this.activeScene.config.Player.Size!==undefined){\r\n        this.player.size=this.activeScene.config.Player.Size;\r\n        this.player.scale();\r\n      }\r\n    }\r\n    //Save game progress\r\n    if(this.activeScene!==this.scenes[this.titleLabel])\r\n      this.storage.save();\r\n  }\r\n\r\n  changeScene(name,playerCoords){\r\n    //Music\r\n    if(this.activeScene.music!==undefined){\r\n      this.sound.stop(this.activeScene.music);\r\n    }\r\n    this.app.stage.addChild(this.blackScreen);\r\n    if(this.tween) this.tween.kill();\r\n    this.tween=TweenMax.set(this.blackScreen, {alpha:0});\r\n    this.tween=TweenMax.fromTo(this.blackScreen, 1,\r\n      {alpha:0},\r\n      {alpha:1, onComplete:this.fadeOutEnd.bind(this),\r\n        onCompleteParams:[name,playerCoords]});\r\n  }\r\n\r\n  fadeIn(){\r\n    //Add our new container\r\n    this.app.stage.addChild(this.activeScene.container);\r\n\r\n    this.app.stage.addChild(this.blackScreen);\r\n\r\n    if(this.tween) this.tween.kill();\r\n    this.tween=TweenMax.set(this.blackScreen, {alpha:1});\r\n    this.tween=TweenMax.fromTo(this.blackScreen, 1,\r\n      {alpha:1},\r\n      {alpha:0, onComplete:this.fadeInEnd.bind(this)}\r\n    );\r\n  }\r\n\r\n  fadeInEnd(){\r\n    this.app.stage.removeChild(this.blackScreen);\r\n    //Music\r\n    if(this.activeScene.music!==undefined && this.playSounds){\r\n      this.sound.play(this.activeScene.music);\r\n    }\r\n  }\r\n\r\n  fadeOutEnd(name,playerCoords){\r\n    this.setScene(name,playerCoords);\r\n    //Check Cutscenes\r\n    if(this.activeScene.config.CutScene!==undefined &&\r\n      !this.cutscenes[this.activeScene.config.CutScene].played){\r\n        this.activeCutscene=this.cutscenes[this.activeScene.config.CutScene];\r\n      //  this.pause();\r\n        this.activeCutscene.show();\r\n    }else{\r\n      this.resume();\r\n    }\r\n\r\n    this.app.stage.removeChild(this.blackScreen);\r\n  }\r\n}\r\n\r\nexport default Game;\r\n","import Game from './game';\r\n\r\nconsole.log(\"JSGAM 5.0.0 https://github.com/kreezii/jsgam\");\r\n\r\n//export default Game;\r\nexport default Game;\r\n"],"names":["Loader","constructor","game","onLoad","add","this","update","bind","onError","error","use","howlerMiddleware","resource","next","includes","extension","options","JSON","parse","stringify","metadata","src","url","sound","Howl","addJSON","files","i","arrayLength","length","name","slice","lastIndexOf","addFiles","data","Settings","settings","Scenes","scenes","concat","Cutscenes","cutscenes","Objects","objects","Dialogues","dialogues","Puzzles","puzzles","Credits","credits","Texts","texts","Sounds","soundSrc","j","tmpSound","Src","Name","Vids","vidSrc","tmpVid","Animations","animSrc","tmpAnim","Backgrounds","bgSrc","tmpBg","Player","Texture","Json","Skeleton","player","Characters","npcSrc","npc","percent","Math","floor","progress","progressBar","width","console","log","PIXI","loaders","Storage","save","puzzlesSolved","Object","values","forEach","puzzle","solved","config","push","dialoguesDisabled","dialogue","branches","branch","Choices","choice","index","disabled","Dialogue","Branch","cutscenesPlayed","cutscene","played","language","activeLanguage","activeScene","sprite","x","y","inventory","setItem","load","disable","Index","silentMode","resolve","item","thisItem","scene","undefined","tmpIndex","indexOf","splice","playerPos","delete","localForage","clear","check","storage","getItem","then","value","changeLanguage","states","enable","catch","err","SoundManager","play","source","resources","loop","stop","on","onFade","fade","volume","Scene","container","Container","setup","background","Sprite","from","Background","anchor","set","addChild","Foreground","foreground","music","Music","dt","hide","visible","show","Button","text","style","interactive","buttonMode","extras","BitmapText","Infotxt","Phrases","option","let","dialogueChoices","Text","ButtonStyle","onTap","height","activeChoice","activeDialogue","currentBranch","alpha","Repeat","get","sort","parent","scale","center","ratio","min","pivot","TextField","Avatar","build","parentLayer","layerUI","WHITE","size","Size","tint","Style","maxWidth","skip","Position","setPosition","end","talker","shutup","answer","setText","activeObject","cancel","clearTimeout","timeoutID","position","newText","adjustText","countWords","str","split","timeOut","time","Speed","setColor","colour","setFont","newFont","font","setAvatar","newAvi","texture","hideAvatar","Menu","buttons","addButton","modify","arrayButtons","resize","MainMenu","create","gameTexts","NewGame","Continue","Options","Help","languages","Languages","addLanguage","setLanguage","Back","father","change","mainMenu","buildText","speed","Time","structuredText","tween","animate","TweenMax","to","Lines","Title","kill","Confirmation","addText","Warning","Yes","No","addState","addAction","showOptions","showHelp","showCredits","checkAdventure","loadAdventure","newAdventure","button","action","state","warning","changeScene","FirstScene","start","latestScene","GameScene","layerTop","layerBottom","getPosition","walkable","Walkable","WalkArea","addPolygon","Obstacles","obstacles","sceneObjects","sceneChars","npcs","event","coord","getLocalPosition","app","stage","lock","move","getPath","fromX","fromY","toX","toY","findPath","CutScene","sequenceIndex","boxesIntersect","a","b","ab","getBounds","bb","collision","result","hitArea","PolyK","points","Video","videoData","videoEnds","addEventListener","Sequence","image","Image","field","videoTexture","videoSprite","adjust","fadeIn","removeChild","fromTo","timer","setTimeout","fadeOut","activeCutscene","pause","removeEventListener","finished","home","resume","playSounds","GameObject","Description","NoDescription","Area","EMPTY","Polygon","Animation","spritesheet","frames","_frameKeys","AnimatedSprite","animationSpeed","Mirror","flip","Layer","layer","Door","door","newScene","To","holding","Lock","locked","touchArea","releaseArea","touch","release","Interactive","setInteraction","setpos","changeTexture","hold","interaction","holdTime","touchedPos","moveTo","area","coords","coordX","round","coordY","changePosition","closestedge","point","norm","Use","activePuzzle","endAction","touched","posX","posY","dragging","oldParent","depthGroup","setParent","newPosition","bounds","icon","Take","hit","found","objectsArray","charsArray","remove","scenesArray","scenesLength","Inventory","border","Icon","click","setIcon","hideIcon","showIcon","off","numObjs","tmpObj","objectHit","Combine","With","Puzzle","say","ModifyObject","objectMod","createDoor","GetObject","AddObject","RemoveObject","RemoveDoor","SetDialogue","Character","Resolve","Say","NPCSay","Sound","sounds","EndGame","target","const","dbfactory","dragonBones","PixiFactory","factory","parseDragonBonesData","parseTextureAtlasData","buildArmatureDisplay","Armature","animations","Stand","closestPosition","obstaclesPolys","walkPoly","newPos","checkPath","finalPath","animationTime","abs","Walk","armature","flipX","activeState","ease","Linear","easeNone","scaleChar","Depth","look","take","talk","textField","Color","Number","Font","animation","times","lastAnimationName","dbEvents","EventObject","checkDirection","activeNPC","once","COMPLETE","takeEnd","useEnd","NotUsable","NPC","pressTimeoutID","distance","moved","firstTime","Branches","DefaultBranch","choiceSelected","searchBranch","branchFound","Answer","Link","EndDialogue","Logo","Logos","setScene","titleLabel","Game","devicePixelRatio","Stage","autoResize","renderer","window","e","preventDefault","document","getElementById","appendChild","view","body","preload","beginFill","drawRect","endFill","loadingTxt","jsons","addZOrder","logo","HoldTime","addScene","TitleScreen","addObject","addNPC","addDialogue","addCutscene","addPuzzle","addInventory","addTextField","addPlayer","addBlackScreen","ticker","object","BottomGroup","Group","sortGroup","zOrder","TopGroup","UIGroup","group","enableSort","char","blackScreen","w","innerWidth","h","innerHeight","location","reload","playerCoords","fadeOutEnd","onCompleteParams","fadeInEnd"],"mappings":"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"}